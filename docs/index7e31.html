<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>未分類 &#8211; susumuis Info</title>
	<atom:link href="https://susumuishigami.github.io/susumuisinfo/?feed=rss2&#038;cat=1" rel="self" type="application/rss+xml" />
	<link>https://susumuishigami.github.io/susumuisinfo</link>
	<description>Webエンジニア susumuis の技術ブログ</description>
	<lastBuildDate>Tue, 04 Dec 2018 02:59:20 +0000</lastBuildDate>
	<language>ja</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=6.4.3</generator>
	<item>
		<title>ビープラウドに入社して2年間で一番学んだこと</title>
		<link>https://susumuishigami.github.io/susumuisinfo/entry/2018/beproud</link>
		
		<dc:creator><![CDATA[susumuis]]></dc:creator>
		<pubDate>Mon, 03 Dec 2018 13:43:59 +0000</pubDate>
				<category><![CDATA[未分類]]></category>
		<guid isPermaLink="false">http://www.susumuis.info/?p=1984</guid>

					<description><![CDATA[この記事は BeProud Advent Calendar 2018 の3日目です。 さて、何書くか考えてなかったまま担当の日を迎えてしまいました。そう言えばちょうど2年前の昨日ビープラウドに入社してから、技術者として転 [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>この記事は <a href="https://adventar.org/calendars/3338">BeProud Advent Calendar 2018</a> の3日目です。</p>

<p>さて、何書くか考えてなかったまま担当の日を迎えてしまいました。そう言えばちょうど2年前の昨日ビープラウドに入社してから、技術者として転職エントリ書いてなかったと思うので今更書こうと思います。（<a href="http://www.maid-cafe.work/2017/304">非技術者向けの転職エントリは書いています</a>）</p>

<h1>何で転職したんだっけ？</h1>

<p>前職では<a href="http://www.maid-cafe.work/2016/246">メイドが原因で失脚</a>しました。というのは半分面白くするための冗談です。今から7年前、前職は小さな会社でしたが<strong>「これから大きくなるぞ！」</strong>という勢いがありました。その時技術リーダーだった僕は発言権もそこそこあり<strong>「良い技術チームを作りたい」</strong>という意欲に燃えていました。しかし結果的によくある保守的な階層組織になってしまい、気づいたら発言権も失い、大変憂鬱な気持ちになっていました。</p>

<p>「当初色々意見を言えたのに、思ったのと違う結果になったのはなぜだろう。」「いっそ自分が作りたかった雰囲気に近いチームに、自らが飛び込んでみたら分かるのではないか？」「じゃあ、それに一番近いのはどこだろう？」そこで注目したのがビープラウドでした。実は、7年前の僕が参考にウォッチしていたいくつかの会社の一つだったんです。</p>

<p>幸い<a href="https://www.beproud.jp/careers/python/">採用ページ</a>を見るとこう思いました。</p>

<p><strong>Python以外のスキルセットはぴったりカバーしているじゃん！！</strong></p>

<p>Pythonが書きたくてビープラウドに入ったわけじゃなくてごめんなさい！ガチガチのJava屋さんだったので入社するまでPythonは全然書いたことがなかったです。Pythonは勉強しました。PyQっていうサービスで！ Dog feeding!?</p>

<h1>ビープラウドに2年いて学んだこと</h1>

<p>流石に2年もいたんだから何か掴めたはずです！入社以来僕を変えたことを、大きかった順に書いてみようと思います。</p>

<h2>1. 時間を大切にする</h2>

<p><a href="http://www.susumuis.info/wp-content/uploads/2018/12/hanashi_nagai_man.png"><img decoding="async" class="alignnone size-full wp-image-1990" src="http://www.susumuis.info/wp-content/uploads/2018/12/hanashi_nagai_man.png" alt="" width="180" height="180" srcset="https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2018/12/hanashi_nagai_man.png 180w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2018/12/hanashi_nagai_man-150x150.png 150w" sizes="(max-width: 180px) 100vw, 180px" /></a></p>

<p><strong>「susumuisは話が長い、文章が長い」</strong>とはめっちゃ言われました。</p>

<p>入社して最初の自己紹介では1時間以上話し続け、その後も社内勉強会で20分の枠に40分話すなど時間配分がとにかく苦手でした。また、文章を書くと「susumuisの文章は長くて読みづらい」とめっちゃ言われました。</p>

<p>人の時間は貴重です。説明が長ければそれだけ相手の時間を奪ってしまいます。相手の時間を尊重する、自分の時間も大切にするという感覚が欠如してたんですね。</p>

<h2>2. わかりやすく伝える努力をする</h2>

<p><a href="http://www.susumuis.info/wp-content/uploads/2018/12/presentation_slide_fukuzatsu.png"><img decoding="async" class="alignnone wp-image-1989" src="http://www.susumuis.info/wp-content/uploads/2018/12/presentation_slide_fukuzatsu.png" alt="" width="165" height="165" srcset="https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2018/12/presentation_slide_fukuzatsu.png 180w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2018/12/presentation_slide_fukuzatsu-150x150.png 150w" sizes="(max-width: 165px) 100vw, 165px" /></a></p>

<p><strong>「もっと分かりやすい図を書いて」</strong>みたいな指導をけっこうされました。</p>

<p>「仕様書は行間読め」僕はそんな文化で感じの人でした。汲める人が偉い人そう思っていました。ところが、この会社の人たちめっちゃ丁寧に設計するし、図で説明するのが上手い人が多いです。</p>

<p>考えてみると、業務の大半って、人から人へ自分の考えを伝えることなんですね。そこを「汲んで」とかやると、意思伝達のミスが多発して、最後はおかしなことになるのだと思います。</p>

<h2>3. 根拠を示す</h2>

<p><a href="http://www.susumuis.info/wp-content/uploads/2018/12/setsumeisyo_man.png"><img decoding="async" class="alignnone size-full wp-image-1988" src="http://www.susumuis.info/wp-content/uploads/2018/12/setsumeisyo_man.png" alt="" width="180" height="180" srcset="https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2018/12/setsumeisyo_man.png 180w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2018/12/setsumeisyo_man-150x150.png 150w" sizes="(max-width: 180px) 100vw, 180px" /></a></p>

<p>入社してから公式ドキュメントを読むことが増えました。社内ではレビューが盛んに行われます。そこでは、その技術判断をした根拠が必要です。まさか「<strong>よくわからないけどQiita読んで適当にやってたらできましたー（・_・）ノ</strong>」じゃダメですよねｗ</p>

<p>意見を言う時に根拠がないと、こう言うしかありません。</p>

<p><strong>「俺が正しい。俺を信じろ！」</strong></p>

<p>それで付いてくる人は少なくともエンジニアじゃなさそうです。。。</p>

<h2>なぜsusumuisは熱い想いを実現できなかったのか！</h2>

<p><strong><span style="font-size: 1rem;">自分がダメだったのは、この逆だったからです／(^o^)＼</span></strong></p>

<p><span style="font-size: 1rem;">頭の中にあった「熱い想い」が、実はちっとも伝わってなかったんですね！それは失脚するわけです！</span></p>

<h1>まとめ</h1>

<p>susumuisがビープラウドに入社して2年を振り返りました。</p>

<ol>
    <li>「良い技術チームを作りたい」という熱い思いが実現できなかった悔しさを持って転職した</li>
    <li>その結果学んだのは次のことだった
<ol>
    <li>時間を大切に。説明は簡潔に。</li>
    <li>相手に伝わりやすく伝える努力をする</li>
    <li>根拠を示して説明する</li>
</ol>
</li>
    <li>たとえ熱い想いがあっても伝える努力をしなければちっとも伝わらない</li>
</ol>

<p>もっと技術的な記事になるかと思ったけど、意外な結果だったなと思います。もちろん技術も学びました。Pythonは不安なく書けるようになったし、機械学習も学びました。でも技術は前提として、致命的な問題によってそれが活かせてなかったのかもしれません。</p>

<h1>BeProudコミュニケーションガイド</h1>

<p>現在社内でライフスタイル・コミュニケーションを作成中です。まだ策定中のβ版ですが、リポジトリは公開されています： <a href="https://github.com/beproud/beproud-guide">beproud-guide</a> 。読んでみると結構この記事で書いたことと近いことが書かれていると思います。</p>

<p>&nbsp;</p>
]]></content:encoded>
					
		
		
			</item>
		<item>
		<title>eclipseでHTMLエディタの文字化けを直す方法</title>
		<link>https://susumuishigami.github.io/susumuisinfo/entry/2018/eclipse_html_charset</link>
		
		<dc:creator><![CDATA[susumuis]]></dc:creator>
		<pubDate>Mon, 23 Jul 2018 03:14:09 +0000</pubDate>
				<category><![CDATA[未分類]]></category>
		<category><![CDATA[開発環境]]></category>
		<guid isPermaLink="false">http://www.susumuis.info/?p=1965</guid>

					<description><![CDATA[EclipseのHTMLエディタはcontent-type記述から文字コードを自動判別するが、DjangoテンプレートのようにHTMLの断片だけのファイルを開くと判別できず文字化けしてしまう。 回避するにはファイル個別に [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>EclipseのHTMLエディタはcontent-type記述から文字コードを自動判別するが、DjangoテンプレートのようにHTMLの断片だけのファイルを開くと判別できず文字化けしてしまう。</p>

<p>回避するにはファイル個別に文字コードを指定すること。フォルダやプロジェクト、ContentTypeのデフォルトの文字コードを指定しても、自動判別をしてしまって強制的にShift_JISとして読み込んでしまう。これを直したい。</p>

<h2>直す方法</h2>

<p>Macの場合</p>

<pre><code class="language-sh">
$ cd /Applications/Eclipse.app/Contents/Eclipse/plugins
$ jar -xvf org.eclipse.wst.html.core_1.3.0.v201804302243.jar plugin.xml plugin.xml
$ vim plugin.xml 
</code></pre>

<p>次の部分 <code>note: no default-charset for HTML, should use 'platform'</code> の下のdescriberをコメントアウトする</p>

<pre><code class="language-xml">
&lt;!-- note: no default-charset for HTML, should use 'platform'
&lt;describer class="org.eclipse.wst.html.core.internal.contenttype.ContentDescriberForHTML" /&gt;
 --&gt;
</code></pre>

<pre><code class="language-sh">
$ jar -uf org.eclipse.wst.html.core_1.3.0.v201804302243.jar plugin.xml plugin.xml 
</code></pre>

<p>これでプロジェクトや親フォルダの文字コードを優先して従うようになった。</p>

<h2>考察</h2>

<p>この動作、Java使いだった頃は全然気にならなかったのに、Python/Django使いになったら真っ先に気になった。</p>

<p>Mayaaテンプレートはブラウザで表示できる「ページ」だから、むしろ自動判別が正しい（忘れてたり指定が間違ったら「正しく化けて欲しい」）。<br />
JSPの場合もpageEncodingディレクティブがある。忘れたらサーバーサイドで化ける。</p>

<p>Djangoテンプレートはいずれの記述もない。この辺りも文化の違いなのかな。</p>
]]></content:encoded>
					
		
		
			</item>
		<item>
		<title>PyPro3は機械学習の仕事に初めて関わるプログラマーにもおすすめの本です</title>
		<link>https://susumuishigami.github.io/susumuisinfo/entry/2018/pypro3</link>
		
		<dc:creator><![CDATA[susumuis]]></dc:creator>
		<pubDate>Sat, 23 Jun 2018 06:21:12 +0000</pubDate>
				<category><![CDATA[未分類]]></category>
		<guid isPermaLink="false">http://www.susumuis.info/?p=1946</guid>

					<description><![CDATA[&#160; ビッグデータの活用が進み、機械学習をシステムに組み込む事例が増えています。これまで Webや業務システムを開発していたプログラマーも、今後「機械学習プロジェクト」に参加することが増えていくでしょう。 しかし [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>&nbsp;</p>

<p>ビッグデータの活用が進み、機械学習をシステムに組み込む事例が増えています。これまで Webや業務システムを開発していたプログラマーも、今後「機械学習プロジェクト」に参加することが増えていくでしょう。</p>

<p>しかし、<strong>初めての分野の仕事は緊張しますし、コツが分かっていないと失敗することがあり、不安</strong>になってしまう方も多いのではないでしょうか。そのような方のために、6月12日に発売した<strong>「<a href="https://amzn.to/2Kbsk1w">Pythonプロフェッショナルプログラミング 第3版</a>」（株式会社ビープラウド著）</strong>では、<strong>第15章</strong>「<strong>プログラマーのための機械学習</strong>」の執筆を担当し、自分が仕事を通じて理解したノウハウや仕事をする上での心がけを書きました。</p>

<iframe style="width: 120px; height: 240px;" src="//rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&amp;bc1=000000&amp;IS2=1&amp;bg1=FFFFFF&amp;fc1=000000&amp;lc1=0000FF&amp;t=esuai-22&amp;o=9&amp;p=8&amp;l=as4&amp;m=amazon&amp;f=ifr&amp;ref=as_ss_li_til&amp;asins=4798053821&amp;linkId=5266f1931e98f0cbde44bd23cb82487c" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" data-mce-fragment="1"></iframe>

<h2>本の概要</h2>

<p>この本はハイレベルなPythonエンジニアが集うビープラウド社が日々の業務で培った開発手法をまとめた本で、ビープラウドのメンバーが分担して執筆しています。この一冊で開発環境の構築、開発チームコミュニケーション、テストやCI、パフォーマンス改善、Djangoから機械学習まで幅広く網羅しています。詳しくは<a href="https://shacho.beproud.jp/">haru</a>, <a href="http://www.freia.jp/taka/blog/python-professional-programming-3rd/index.html">shimizukawa</a>, <a href="https://blog.mtb-production.info/entry/2018/06/15/192053">mtb_beta</a>が書いている記事を御覧ください。</p>

<p>すでに多くの方がお買い上げいただいているようで、一時、<strong>Amazonの開発技法カテゴリで売れ筋1位</strong>だったそうです。ここでは、既にお買い上げ頂いた方でこれから15章を読む人に向けて、まだお買い上げいただいていない方に15章という切り口での宣伝を少し書かせていただきます。</p>

<p><a href="http://www.susumuis.info/wp-content/uploads/2018/06/P_20180606_162056_vHDR_Auto-e1529732958347.jpg"><img loading="lazy" decoding="async" class="alignnone size-medium wp-image-1947" src="http://www.susumuis.info/wp-content/uploads/2018/06/P_20180606_162056_vHDR_Auto-300x237.jpg" alt="" width="300" height="237" /></a></p>

<h2>15章は誰に読んでほしいか</h2>

<p>冒頭に書いたとおり、<strong>これから機械学習を仕事として経験するプログラマー</strong>を主なターゲットとしていますが、次のような幅広いにも読んで頂けるのではないかと思います。</p>

<ul>
    <li>プログラマーを管理するプロジェクトマネージャー</li>
    <li>システム開発会社の経営者</li>
    <li>機械学習を扱うコンサル</li>
</ul>

<p>Pythonプロフェッショナルプログラミング全体の読者層を想定しているため、プログラミングの知識は前提として書いていますが、数式など機械学習やデータサイエンスの専門知識は一切不要です。</p>

<h2>15章執筆者の狙い</h2>

<p><em>「教師あり、教師なし、強化学習に分かれ、教師あり学習は分類、回帰がある」</em>といったよくある説明は一切カットしました。それらを説明している本はたくさんあるからです。今、専門知識を教えてくれる本はたくさん出ています。自分も<a href="https://akiba-tech-reading.connpass.com/">読書会</a>を通じて勉強する場を作っています。</p>

<p>一方、プログラマー視点での「仕事の進め方」の本は現時点ではありません。</p>

<p>本職のプログラマーのみなさんが仕事を始めた時、専門知識以外に何を覚えたでしょうか？<strong><em>「</em></strong><span style="font-size: 1rem;"><strong><em>要件定義、設計、開発、テスト、納品」</em></strong>という仕事の流れとスケジューリングの大切さではないでしょうか？仕事の流れがわかっていれば、優先順位やスケジュール感を身につけることができます。それが分かれば適切なタイミングでマネージャーに相談することもできます。</span></p>

<p><span style="font-size: 1rem;">しかし、機械学習の仕事では、ウォーターフォールのような開発モデルをうまく適用できません。そこで、<strong>従来のシステム開発の知識がある人に何を補ったら効率よく仕事で活躍できるのか？</strong>そのことに注力して執筆しています。</span></p>

<h2>15章に書いたこと書かなかったこと</h2>

<p>よって、この章を読んだ人が得られると思うことは次のことです</p>

<ul>
    <li>「機械学習」のざっくりした概念</li>
    <li>機械学習を含んだプロジェクトの全体像とスケジュール感</li>
    <li>仕事をする上での心がけや作業の優先順位</li>
</ul>

<p>一方、次のことは書いていません</p>

<ul>
    <li>機械学習の専門知識</li>
    <li>機械学習アルゴリズムの説明</li>
    <li>数学的な理論</li>
</ul>

<p>これらを補うため、章末に参考書籍が書いてあります。これは筆者も実際に読んで学んだ本なので、順に読めば既に僕と同じレベルに達するとご理解ください。なお、今後僕の主催の<a href="https://akiba-tech-reading.connpass.com/">読書会</a>でもこれらの本を扱っていくかもしれません。</p>

<p><a href="http://www.susumuis.info/wp-content/uploads/2018/06/P_20180606_181412_vHDR_Auto.jpg"><img loading="lazy" decoding="async" class="alignnone size-medium wp-image-1951" src="http://www.susumuis.info/wp-content/uploads/2018/06/P_20180606_181412_vHDR_Auto-300x225.jpg" alt="" width="300" height="225" srcset="https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2018/06/P_20180606_181412_vHDR_Auto-300x225.jpg 300w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2018/06/P_20180606_181412_vHDR_Auto-768x576.jpg 768w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2018/06/P_20180606_181412_vHDR_Auto-1024x768.jpg 1024w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2018/06/P_20180606_181412_vHDR_Auto-624x468.jpg 624w" sizes="(max-width: 300px) 100vw, 300px" /></a><br />
15章の冒頭</p>

<h2>15章の構成と担当チーム</h2>

<p>15章は次のように4部構成になっています。</p>

<ol>
    <li>機械学習とは</li>
    <li>機械学習プロジェクトの概要</li>
    <li>事前検証フェーズ</li>
    <li>機械学習の開発環境を準備する</li>
</ol>

<p>自分はこの中でも1〜3節を執筆しました。しかし実際は1、2節は非常に短いので、実質1〜3節で1セットだとご理解ください。</p>

<p>4節は同僚で、同じく機械学習案件を多数経験し、専門知識やライブラリの使い方の知識が豊富な先輩であるmasayaが執筆しています。masayaと僕は同じプロジェクトのチームになったことがあり、僕が外部調整や個々の処理の糊付け的な開発を担当し、内部のエンジンをmasayaが作りきるという役割分担をして大きな機械学習システムを完成させた仲です。今回も同じチームで1つの章を担当できたことを嬉しく思います。</p>

<p>章末コラム「機械学習で知っておきたいプログラミングテクニック」は2人の合作です！実際の仕事を通じて切実に感じたことを厳選して書いています。</p>

<h2>はじめての執筆の感想</h2>

<p>2017年9月末に執筆を開始、3月に脱稿、その後度々レビューを直しを経て5月にようやく最終稿を出すことができました。</p>

<p>脱稿まで一体どんな文章を僕が書いていたのか、多くの方にはご心配をおかけしたと思います。僕自身何度もほぼ一から書き直し、構成にドラスティックな変更を加え、一日中日本語のリファクタリングに追われる日々でした。</p>

<p>脱稿後のレビュー直しも大変で、最後は自分一人で文章を書くことができなくなり、意見をくれた数人を招集し、修正方針を練る会議を行っていました。</p>

<p>初めての執筆だったので、執筆チーム、レビュアーチームの皆さんには大変ご迷惑をおかけしました。特に全体のマネージメントを行う傍ら苦しむ僕の道筋を示し続けてくれた<a href="https://twitter.com/takanory">takanory</a>、同じ章担当で積極的に意見をくれたmasaya、レビューで厳しい指摘と温かいアドバイスをくれた<a href="https://twitter.com/haru860">haru</a>, <a href="https://twitter.com/shimizukawa">shimizukawa</a>, <a href="https://twitter.com/kashew_nuts">kashew_nuts</a>, <a href="https://twitter.com/mtb_beta">mtb_beta</a>, tsutomu, <a href="https://twitter.com/hajime_nakagami">nakagami</a>、説明を分かりやすくするために協力してくれた<a href="https://twitter.com/natsu_bm">natsu</a>, <a href="https://twitter.com/NaoY_py">nao_y</a>に感謝します。</p>

<p><a href="http://www.susumuis.info/wp-content/uploads/2018/06/P_20180606_162056_vHDR_Auto-1.jpg"><img loading="lazy" decoding="async" class="alignnone size-medium wp-image-1952" src="http://www.susumuis.info/wp-content/uploads/2018/06/P_20180606_162056_vHDR_Auto-1-286x300.jpg" alt="" width="286" height="300" srcset="https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2018/06/P_20180606_162056_vHDR_Auto-1-286x300.jpg 286w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2018/06/P_20180606_162056_vHDR_Auto-1-768x806.jpg 768w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2018/06/P_20180606_162056_vHDR_Auto-1-975x1024.jpg 975w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2018/06/P_20180606_162056_vHDR_Auto-1-624x655.jpg 624w" sizes="(max-width: 286px) 100vw, 286px" /></a><br />
見本を手に取りはしゃいで自撮りする僕</p>

<h2>まとめ</h2>

<p>以上、<a href="https://amzn.to/2Kbsk1w">Pythonプロフェッショナルプログラミング 第3版</a>は「機械学習」の本としても他の本では得られない、個性的な位置づけの内容を含んでいるますので、是非読んでいただければと思います。</p>

<p>まだ、ご購入いただいていない方は、全国の書店またはAmazonなどで購入できます。電子書籍版もあります。</p>

<iframe style="width: 120px; height: 240px;" src="//rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&amp;bc1=000000&amp;IS2=1&amp;bg1=FFFFFF&amp;fc1=000000&amp;lc1=0000FF&amp;t=esuai-22&amp;o=9&amp;p=8&amp;l=as4&amp;m=amazon&amp;f=ifr&amp;ref=as_ss_li_til&amp;asins=4798053821&amp;linkId=5266f1931e98f0cbde44bd23cb82487c" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" data-mce-fragment="1"></iframe>
]]></content:encoded>
					
		
		
			</item>
		<item>
		<title>エンジニアが機械学習を仕事とする周辺環境</title>
		<link>https://susumuishigami.github.io/susumuisinfo/2017/engineer_machinelearning_work</link>
		
		<dc:creator><![CDATA[susumuis]]></dc:creator>
		<pubDate>Mon, 09 Oct 2017 02:37:05 +0000</pubDate>
				<category><![CDATA[未分類]]></category>
		<guid isPermaLink="false">http://www.susumuis.info/?p=1860</guid>

					<description><![CDATA[メイドカフェでノマド会 座談会開催しました！ を開催しました。 資料はこちらです。 僕はエンジニア視点で話しましたが、コンサルの方の参加もあって、話が広がりました。ここ数ヶ月もやっと思っていたことが議論をすることで腑に落 [&#8230;]]]></description>
										<content:encoded><![CDATA[<p><a href="http://www.maid-cafe.work/">メイドカフェでノマド会</a> <a href="https://maid-cafe-nomad.connpass.com/event/69111/">座談会</a>開催しました！</p>

<p>を開催しました。</p>

<p>資料はこちらです。</p>

<iframe loading="lazy" src="https://docs.google.com/presentation/d/e/2PACX-1vTmn0nbLLFtpf8uEaUfxzBZbBIC24pI6mZPXZwK1QtF3XctNJcBd3lpF1E9K0dF4mWmP8pT2fnJAcoE/embed?start=false&loop=false&delayms=3000" frameborder="0" width="960" height="569" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>

<p>僕はエンジニア視点で話しましたが、コンサルの方の参加もあって、話が広がりました。ここ数ヶ月もやっと思っていたことが議論をすることで腑に落ちた感じがします。若い学生の方の意見も聞くことができたこともよかったと思います。</p>

<p>議論の内容は結論はスライドに書いているとおりですので、そちらをご覧ください。</p>

<p>今後もこのようなプチイベントの開催を増やしていこうと思います。「参加したい！」「こんな企画をやりたい！」と思われた方はまずは、<a href="http://www.maid-cafe.work/">ノマド会の公式サイト</a> にアクセスし、Slack, connpassに登録いただき、 Slack 上で声をかけていただければと思います。</p>
]]></content:encoded>
					
		
		
			</item>
		<item>
		<title>「Swift」という名のバンドを見つけたから、エンジニア代表として話を聞いてきた</title>
		<link>https://susumuishigami.github.io/susumuisinfo/entry/2017/swift_band_interview</link>
					<comments>https://www.susumuis.info/entry/2017/swift_band_interview#respond</comments>
		
		<dc:creator><![CDATA[susumuis]]></dc:creator>
		<pubDate>Thu, 12 Jan 2017 07:07:51 +0000</pubDate>
				<category><![CDATA[未分類]]></category>
		<guid isPermaLink="false">http://www.susumuis.info/?p=1785</guid>

					<description><![CDATA[皆さん、Swift書いてますか？ 今やObjective-Cじゃなくて、iOSアプリ開発はSwiftです！今年は「Android、もしやお前も！？」みたいな噂もあったりしました。既に多くの企業が注目していると言われる言語 [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>皆さん、Swift書いてますか？</p>

<p>今やObjective-Cじゃなくて、iOSアプリ開発はSwiftです！今年は<strong><a href="http://thenextweb.com/dd/2016/04/07/google-facebook-uber-swift/">「Android、もしやお前も！？」</a></strong>みたいな噂もあったりしました。既に多くの企業が注目していると言われる言語、もうエンジニアたるもの勉強しておかなければヤバイ雰囲気があります。</p>

<p>そんな中、今日はプログラム言語ではなく同じ「Swift」という名前で活動しているバンドを見つけたので紹介します。まあ、こじつけネタｗｗｗと言わず、読んで欲しく思います。というのは、<strong>なんてGooglavility低いバンド名なんだ！</strong> さぞかし、SEOでは苦労しているだろうと、興味が湧いて、勢いでインタビューしてみたら、想像以上にイイ話が聞けてしまいました。</p>

<h2>Swiftとは</h2>

<p><a href="http://www.swift-inc.net/"><img loading="lazy" decoding="async" src="http://www.susumuis.info/wp-content/uploads/2016/11/454a84_a9987cb3d43b45be83f88a6f04638536.png" alt="" width="210" height="92" class="alignnone size-full wp-image-1797" /></a></p>

<p><a href="http://www.swift-inc.net/">Swift</a> は、《会社》をコンセプトにして2015年4月から活動を開始したバンドグループで、リーダー兼ギタリストのホッタとヴォーカルの多田を中心に活動中。代表曲は「<a href="https://www.youtube.com/watch?v=F9BTHVf4rWo">オレンジ</a>」「<a href="https://www.youtube.com/watch?v=YIYIzvQBBDo">手のひら</a>」「<a href="https://www.youtube.com/watch?v=8_UN-0hIP7c">BRAVER</a>」</p>

<iframe loading="lazy" width="560" height="315" src="https://www.youtube.com/embed/8_UN-0hIP7c" frameborder="0" allowfullscreen></iframe>

<h2>リーダーのホッタくんと僕の仲</h2>

<p>何を隠そう、僕とホッタくんは小学校の同級生で、今回のインタビューは久しぶりの再会でした。なので終始砕けた会話になっていることを、ご容赦ください。</p>

<p>もちろん、文章を校正して固い言葉に直すこともできたのですが、彼の人間性、思いを伝えるには、このままの方が良いと思います。</p>

<p><div id="attachment_1788" style="width: 365px" class="wp-caption alignnone"><a href="http://www.susumuis.info/wp-content/uploads/2016/11/P_20161105_205723.jpg"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-1788" src="http://www.susumuis.info/wp-content/uploads/2016/11/P_20161105_205723.jpg" alt="ホッタくん" width="355" height="512" class="size-full wp-image-1788" srcset="https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2016/11/P_20161105_205723.jpg 711w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2016/11/P_20161105_205723-208x300.jpg 208w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2016/11/P_20161105_205723-624x899.jpg 624w" sizes="(max-width: 355px) 100vw, 355px" /></a><p id="caption-attachment-1788" class="wp-caption-text">ホッタくん</p></div></p>

<h2>Swiftの名前は「響き」で選んだ</h2>

<p><strong>susumuis:</strong> 早速だけど、Swiftの名前の由来ってなに？</p>

<p><strong>ホッタ:</strong> 由来？そうだなあ。「響き」かな。</p>

<p><strong>susumuis:</strong> 響き？</p>

<p><strong>ホッタ:</strong> 「優しい」「耳馴染みの良い」感じ。ほら、印象ってあるじゃん。強そうな人は強そうな名前だし、僕も一緒にやってるタダくん（「ハリー」って呼んでるんだけど）も、僕ら二人「優しい」イメージって言われるんだ。</p>

<p><strong>susumuis:</strong> へえ</p>

<p><strong>ホッタ:</strong> 第一印象で決めるのは良くないけど、人の性格って顔に出るよね。バンドにとっては、名前が一つの「顔」で「名刺」なんだよ！</p>

<p><strong>susumuis:</strong> Appleの言語と名前がかぶったのはどう思うの？</p>

<p><strong>ホッタ:</strong> 実はあっちの方が先で、知ってたんだよね。あと、音楽の世界では世界一稼いだ女性アーティスト「テイラー・スウィフト」もいるし、検索で勝てるわけがない！それでも「僕らに合ってるね」って選んだんだ</p>

<p><strong>susumuis:</strong> 今検索してみたら、金融業界でも、<a href="https://www.swift.com/ja">SWIFT</a>って組織があるよ！</p>

<h2>就職しても音楽はできる！</h2>

<p><strong>ホッタ:</strong> Swiftのメンバーって実は全員就職しているんだ。仕事をやりながらでも、やりたいことを実現したいと思ってる。みんな仕事には責任があるから、それは守っていきたい。だから、仕事が最優先で活動してる。</p>

<p><strong>susumuis:</strong> そうなんだ！</p>

<p><strong>ホッタ:</strong> 「会社があるから」諦めてるやつ多いんじゃないかな？でも、「挑戦した？」「やろうとすればできるじゃん！」って証明したい。挑戦しないで口だけの人多いから。</p>

<p><strong>susumuis:</strong> 僕らエンジニアの世界でもそういうのあるよ!「仕事が忙しい！」とか言って挑戦しない人。でも、やっている人はやっていて、気がついたら大きく差が開いちゃうんだよね。</p>

<p><strong>ホッタ:</strong> でも、正直続けることの難しさはあるよ。「日本は音楽を続けるのは難しい」と言われるんだ。「バイトで生計立てて夢を目指す」人が多いんだけど、最終的に諦めるんだよね。「そろそろ就職しなきゃ」って言って。でも、「就職してもできるよ！って伝えたい。</p>

<p>「責任ある仕事をしている」というホッタの会社の名刺を見せてもらったら、とても立派な肩書がついていました！</p>

<h2>《会社》をコンセプトにしたのは、人の大切さを伝えたいから</h2>

<p><strong>susumuis:</strong> コンセプトは「会社」ってことだよね。でも、正直言うと申し訳ないんだけど「会社」ってほら、ネガティブなイメージあって！「今日も残業だ。」とかへとへとになって、ライブに行ったら「また会社kayo。。。」みたいにならないの？</p>

<p><strong>ホッタ:</strong> 会社ってそういうイメージもあるよねー。。。でも僕らにとっては「会社」＝「ファミリー」なんだ。同じ目標を持って、志は同じでやりたいことをやる。そういう人たちが集まっていれば「辛いことがあっても、楽しい」と思えることが多いんじゃないかな！</p>

<p>「家族型経営」と呼ばれた会社の姿。それこそが真の会社のあり方なのかもしれません。リストラや経営合理化による非正規雇用の増加で「人が駒のように扱われている」今が異常なのかも。今こそ、「会社」をテーマにしたバンドをやる意味があるじゃないかと、聞いていて思っていました。</p>

<h2>現実は厳しいけど、僕達は恵まれている！</h2>

<p><strong>ホッタ:</strong> そういうわけで、僕らは「仕事を大事にする」って事情だから、あまり多く活動ができないんだ。ライブも年に数回しかできない。普通のバンドは活動をしなければファンが減ってしまうから普通はライブを一杯やるんだ。別のバンドと共同でライブやったりしてね。そういうのを「タイバン」って言うんだけど。そして赤字でもライブをやる。僕らはそのやり方はどうなのかな？って思っているよ。</p>

<p><strong>susumuis:</strong> それでもこの間のライブではライブハウスを満員にして大盛り上がりだったよね！あの時は何人いたの？</p>

<p><strong>ホッタ:</strong> 100人くらいだよ！僕たちみたいに、バックボーンがない、事務所がついているわけでもない、そういうスタイルでは、この人数は多い方だと思う。僕達は恵まれているって思うよ！</p>

<h2>「オレンジ」を卒業ソングとして広げたい</h2>

<p><strong>susumuis:</strong> 最初「オレンジ」や「手のひら」を聴いた時、「なんて優しい歌なんだろう」って思ったよ。あの曲はどういう思いが込められているの？</p>

<p><strong>ホッタ:</strong> 「オレンジ」は「卒業」をテーマにしているんだけど、「卒業しても会えるでしょう？また違う仕事で繋がれるじゃん！その時は、当時と同じ距離感で接することができたら素敵だよね！」って思いが込められてるんだ。</p>

<iframe loading="lazy" width="560" height="315" src="https://www.youtube.com/embed/F9BTHVf4rWo" frameborder="0" allowfullscreen></iframe>

<p><strong>susumuis:</strong> ITエンジニア代表として共感する！僕らは比較的流動性の激しい職業で「転職」ってありふれているんだ。お陰でしょっちゅう「卒業」してる。で、前に仕事したことがる人と、また一緒に仕事してたりするよ！だから、「卒業」のたびにこの人とまた仕事ができる日が来る！って思ってる。今の時代の「卒業」ってそうなのかもね。SNSの普及で普通に会えるし。</p>

<p><strong>ホッタ:</strong> できれば卒業ソングとして定着させたいな。学校とかで、卒業式に合唱してくれたらいいな。</p>

<h2>真面目にやっているから、ファンが離れない</h2>

<p><strong>susumuis:</strong> 偏見で申し訳ないけど「バンドマン」ってチャラいやつが多いってイメージあるじゃん。実際はどうなの？</p>

<p><strong>ホッタ:</strong> 実際そういうの多いよ。僕らは先輩にも「お前らは本当に真面目だな」って言われるよ。だからなのかもしれないけど、一度ファンになったら離れる人が少ないように思う。</p>

<h2>中学生の女の子が自分を「尊敬する人」と言ってくれた</h2>

<p><strong>ホッタ:</strong> 今までで一番うれしかったことで、中学生の女の子が学校の発表で自分を「尊敬する人」として紹介してくれたんだ。</p>

<p><strong>susumuis:</strong> その子は元からの知り合い？</p>

<p><strong>ホッタ:</strong> いや、元は相方のファンでライブに来てくれたんだけど、僕とは初対面。ネット番組とかで僕の思いとかを知ってくれて。</p>

<p><strong>susumuis:</strong> それは嬉しいね！思うんだけど、バンドとか、アイドルとか表に出る人は若い人に影響を与えるから「ちゃらい」とかじゃなくてお手本としての責任も感じてるんじゃないかな。</p>

<p><strong>ホッタ:</strong> そういう意味だと、TwitterとかSNSには気を遣っているよ！若い子が見ているから、自分がどう見られてるか。常にポジティブにして、ネガティブな言葉は書かないように気をつけてる。そこはオープンな場だから。仲間内だけのクローズドな場所じゃないからね。</p>

<iframe loading="lazy" width="560" height="315" src="https://www.youtube.com/embed/YIYIzvQBBDo" frameborder="0" allowfullscreen></iframe>

<h2>今後は活動を加速していきたい！</h2>

<p><strong>susumuis:</strong> 今後の展望とかはあるんですか？</p>

<p><strong>ホッタ:</strong> 活動を長く続けていきたいと思う。来年の4月で活動3年目なのでアクセルを踏んで活動をスピードアップしたいと思ってる。ライブ会場を大きくしたりね。それは大変になるかもしれないけど、沢山の人に知ってもらえたら良いなって。でも、いろんなことに手を出したら中途半端になるから、絞って行きたいとは思ってるよ。</p>

<p><strong>susumuis:</strong> 期待してます！</p>

<h2>今の時代は「人」が中心</h2>

<p>ホッタくんの話を聞いていると、彼は思ったことを本当に率直に話してくれる人だなと思いました。そして根が明るいから、話してるこっちもだんだん楽しくなってきました。</p>

<p>彼らから学べることはこういうことなんじゃないかと思いますが、これは我々エンジニアにも大切なことだと思います。</p>

<ul>
<li>挑戦すること</li>
<li>人を大切にすること</li>
<li>まじめにコツコツやること</li>
</ul>

<p>これからも一層活躍されることをお祈りします。</p>

<h2>ライブ情報</h2>

<p>2月11日にワンマンライブがあります！</p>

<p><a href="http://www.swift-inc.net/news">http://www.swift-inc.net/news</a></p>
]]></content:encoded>
					
					<wfw:commentRss>https://www.susumuis.info/?feed=rss2&#038;p=1785</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Javaが僕にくれたもの</title>
		<link>https://susumuishigami.github.io/susumuisinfo/entry/2016/java_advent</link>
					<comments>https://www.susumuis.info/entry/2016/java_advent#respond</comments>
		
		<dc:creator><![CDATA[susumuis]]></dc:creator>
		<pubDate>Sat, 03 Dec 2016 07:57:48 +0000</pubDate>
				<category><![CDATA[未分類]]></category>
		<guid isPermaLink="false">http://www.susumuis.info/?p=1809</guid>

					<description><![CDATA[この記事はJava Advent Calendar 2016の3日目です。2日目はmegascusさんのどこからも使用されてないクラスを列挙する、4日目はcero_tさんです。 退職しました 個人的な話で恐縮ですが、去る [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>この記事は<a href="http://qiita.com/advent-calendar/2016/java">Java Advent Calendar 2016</a>の3日目です。2日目は<a href="http://qiita.com/megascus">megascus</a>さんの<a href="http://d.hatena.ne.jp/megascus/20161202/1480636922">どこからも使用されてないクラスを列挙する</a>、4日目は<a href="http://qiita.com/cero_t">cero_t</a>さんです。</p>

<h2>退職しました</h2>

<p>個人的な話で恐縮ですが、去る11月末をもって学生バイト時代も含めて12年間勤めた会社を退職しました。そこではずっとJavaを書いていましたが、次の勤務先ではPythonを書くので、今後Javaを書くことは少なくなるでしょう。</p>

<p>退職エントリは書きませんが、代わりに言語の卒業エントリを書こうと思います。一人よがりなネタですがお許し下さい。</p>

<h2>初めての出会いはJDK 1.1をダイアルアップでダウンロードしたこと</h2>

<p>正確な時期は忘れましたが、1997-8年頃ではなかったかと思います。「Javaという言語がすごいらしい」という噂をきいて、ダイヤルアップ回線で頑張って一晩くらいかけてダウンロードしてみました。その時落としたのはJDK 1.1ではないかと思います。</p>

<p>しかし、当時使っていたPentium 90MHzのマシンではサンプルアプレットのローディングに数分かかり、クリックの応答に数十秒かかるという状況でした。（「Java遅い！」をリアルで体験した世代です）</p>

<h2>初めてまともに使ったのは、i-appliの開発</h2>

<p>時は流れて、2001年1月「NTTドコモの新機種F-503i, P-503iが、Javaに対応して誰でもアプリが作れるようになった！」というニュースが入ってきました。この時高校生だったのですが</p>

<p>「これはやばい！ケータイがPCになってしまう！」</p>

<p>とか言って、親に土下座して買ってもらいました。</p>

<p>Javaといっても、CLDC(Connected Limited Device Configuration) 1.0という仕様の上に作られたJavaであって、「浮動小数が使えない」などの制限があり、しかもアプリ(すなわちjarファイル一個)のサイズは10KB以下に収めなければなりません。そこではclassファイルを増やすと容量がかさむから「クラスは一個にしましょう」と言われていました。Eclipseはまだなくて、JBuilderは僕のPCでは重いから、[CPad for Java] (http://hp.vector.co.jp/authors/VA017148/pages/cpad.html) というテキストエディタにコンパイラショートカットがくっついたようなエディタで頑張ってコーディングしていました。これと、コードの変数名を1文字にして容量を削る今で言うminifyツールみたいなのも使っていました。</p>

<p>その時作った<a href="https://gist.github.com/susumuishigami/1307015">作品はgistに貼ってあります</a>。<a href="http://forest.watch.impress.co.jp/library/software/bunshidekiru/">高校の先輩がVBで作ったゲーム</a>を移植したものです。当時は雑誌の端に載ったりしました。</p>

<h2>大学に入ってJavaらしくないJavaを学ぶ</h2>

<p>2003年に大学生になったのですが、当時入った学科では、プログラミング教育にJavaを使っているということで、楽しみにしていました。ところが、そこで習ったJavaと言うのは</p>

<p>「配列をReturnする『関数』を作ってはいけない」<br />
「まず配列を作ってメモリを確保しろ、その配列を関数のパラメータに突っ込め！」</p>

<p>みたいなやつでした。。。＼(^o^)／</p>

<h2>本当のJavaを求めてある本に出会う</h2>

<p>そんな時に出会った本がこれでした。</p>

<iframe style="width:120px;height:240px;" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" src="//rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=esuai-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=as_ss_li_til&asins=4798006289&linkId=a12be463f38790e812896f1882e96924"></iframe>

<p>今思うと現場思考で、非常にバランスの良い本だったと思います。</p>

<p>これで、少しはクラスとかデザインパターンというものを知った僕が、少しはプロセッサーパワーがましになった当時の携帯向けに作り直したのが[これ] (https://github.com/susumuishigami/bunshi2) です。</p>

<p>最近このコードをほぼそのままコピペして環境に依存する部分だけ書き換えてみたら、あっさりAndroidで動いてしまいました！</p>

<h2>仕事でサーバーサイドJavaの世界へ</h2>

<p>大学2年生の時から、プログラミングのバイトを初めます。従業員10人くらいのこじんまりとした会社でした。</p>

<p>始めて突っ込まれた案件は、Atg Dynamoというフレームワークを使っていました。すごい重量級フレームワークでした。二度と使いたくありません。</p>

<h2>自社開発の仕事にアサインされる</h2>

<p>その案件が終わってからは、ほぼ一貫して自社開発の製品の新規開発・カスタマイズをやっていました。そこで使っていた自社フレームワークはシンプルで使いやすかったですが、データは全部文字列で扱う流儀で、HashMapみたいなデータ構造に</p>

<pre><code class="language-java">set(“LAST_NAME”, “hogehoge”);
set(“FIRST_NAME”, “hugahuga”);
</code></pre>

<p>みたいなコーディングスタイルでした。。。まさか、このフレームワークをその後10年使い続けるとは思わなかった＼(^o^)／</p>

<h2>システムのリニューアルを任され、自由に学べる期間があった</h2>

<p>ベンチャー企業というのは、何が正しいかよりも目の前の問題を最短で解決するのが良いとされることがあるので、その場限りの仕事を数年続けました。</p>

<p>転機は2008年の暮れ、主力システムをリニューアルする任務を与えられ、自由にやっていいと言われました。そこで、当時のトレンドだったWicket、Seasar、Spring、Google Guiceなどを全力で追いかけてみました。</p>

<p>本当はこの時社内標準フレームワークを刷新したかったのですが、工数を考えると既存資産を活かすことがどうしても必要だったので、従来の自社フレームワークに僕がOSSから学んだエッセンスを加えるという方針にしました。そのため、「フレームワークの使い方」より、フレームワーク自体のソースコードを読むようになり、特に、Seasar2のソースコードは読みやすくて勉強になりました。（Apacheライセンスなので流用もしやすく助かりました！）</p>

<p>結局、テンプレートエンジンとしてMayaaだけ採用しましたが、たまたまその後作ったサービスが成長したため、最もMayaaを使い倒している人みたいになってしまいました。</p>

<h2>エンジニアとしての目標: 30までに勉強会で登壇する</h2>

<p>僕は家庭の事情もあって、2009年ごろまで、IT系勉強会というものに参加したことがありませんでしたが、このまま無名のエンジニアではいたくないと思い、「30歳までに勉強会で登壇する」ことを目標としていました。</p>

<p>結果的には、<br />
2012年と、<a href="http://www.susumuis.info/entry/20131111/p1">2013年のJJUG CCC</a>当時、28, 29の時に実現できたので、目標は達成したことになります。</p>

<p>Season Conferenceは2010を最後にしばらく開催されませんでしたが、もし、2011年に開催されていたら、この、2013年のネタはその時できたと思います。</p>

<h2>最後のSeasar Committerになる</h2>

<p>そして、久しぶりに開催された2015年のSeasar Conferenceが開催されこんなLTをし、</p>

<iframe loading="lazy" src="http://www.slideshare.net/susumuishigami/slideshelf" width="615px" height="470px" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:none;" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe>

<p>その後、初めてMayaa初代メインコミッターの栗原さん、現メインコミッターの須賀さんに出会うことができ、そのまま流れで僕もコミッターにしていただきました。そしてどうなったかはこのスライドのとおりです。</p>

<iframe loading="lazy" src="https://docs.google.com/presentation/d/e/2PACX-1vQxdwtagM8DmGGCp2spI_LGtWO0sSa3C7AgSTLr0aK30rOC3GJol4HC0Glfemvpm1pMgFNJ5f44TX-Y/embed?start=false&loop=false&delayms=3000" frameborder="0" width="480" height="299" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>

<p>コミッターになってからした仕事は<a href="http://qiita.com/advent-calendar/2015/mayaa">Mayaa Advent Calendar 2015</a>を書いたことくらいです。コミットしてないです。（今後必要があったら、コミットすることもあるかもしれません。コミッターになる前はバグ報告をしてパッチを送ったり、GitHubになってからは、PullRequestを送ったことがあります）</p>

<h2>振り返って、Javaと僕の付き合いは何だったのか</h2>

<p>僕はJavaで12年仕事のコードを書いてきましたが、今の今まで、J2EE、Java EEのような世界は、Servlet/JSPくらいしか経験がありません。EJBも書いたことがありませんし、JPAも使わず生のJDBCに独自ラッパーをかぶせてなんとかしました。SpringやSeasarContainerも業務で使ったことはありません。</p>

<p>勉強して、こういうの良いなと思ったら、ポイントポイントでどんどん取り入れていきました。アプリケーション・サーバーは、Tomcatくらいしか使っていません。そのため、本来であればアプリケーションサーバーが提供してくれるような機能も自作しました。</p>

<p>こういうところは、このあたり、一般的なJavaプログラマーとは違うかもしれません。</p>

<p>それならいっそ、PHPを使えば良いんじゃないかと言えますが、静的型付け言語であるJavaのIDEの実力・Eclipseにはお世話になりました。サービス開発初期は何が正解なのか分からず、動かしながら抜本的に作り直すなんてこともあります。その時、呼び出し階層・型階層の機能がなければつらいかった。</p>

<p>ただ、中盤以降はIDEに頼り切るスタイルが仇となって、どんどん重たくなって苦しくなりました。</p>

<p>持論ですが、ある程度大規模になると、場当たり的な設計をやめ、モノリシックをやめ、きちんと設計して、適度にマイクロサービスみたいにモジュール分割するのが正解だと思います。そして、各マイクロサービスは、JavaよりもLLの方が書きやすいと思っています。</p>

<h2>Javaプログラマーから見たPython</h2>

<p>新天地ではPythonistaになります。まだ一ヶ月くらいしか触っていませんが、Pythonは非常にとっつきやすい言語だと思いました。同じことができるフレームワークやライブラリが乱立せず、体系的に整っているように見えます。</p>

<p>お陰で非常に入門しやすく、何かをするにあたって迷ったりはまったりすることが極端に少ない言語だと思いました。</p>

<h2>Javaは僕の育ての親</h2>

<p>しかしJavaはSeasar Project等、日本発のJavaのOSSという教材に恵まれているために、質の良いコードを読ませてもらって学習させてもらえたことはかけがえのない経験だったと思います。</p>

<p>初めて触ったプログラミング言語はObject Pascal(Delphi2.0)ですが、業務で実用的に使い、多くの先人の知恵を学ばせてもらった、僕の育ての親はJavaであることは間違いありません。</p>

<p>これからはEclipseを起動することも少なくなると思います。そのうちショートカットも忘れてしまうかもしれません。それでも、僕のプログラミング哲学に影響を与えたのは、Javaであり、とりわけ、Seasar Project関係のOSSのそれぞれの開発者の方々の知恵を借りてこれからも頑張っていきたいと思います。</p>

<h2>番外編 java-ja について</h2>

<p>僕にとって java-ja は発足当時から憧れのコミュニティでしたが、家庭の事情でイベントに参加することは今まで一回もできませんでした。この記事が公開される12/3には java-ja 忘年会があって、実は java-ja のイベント初参加です。</p>
]]></content:encoded>
					
					<wfw:commentRss>https://www.susumuis.info/?feed=rss2&#038;p=1809</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Bash on Windowsを入れてみてやってみたこと</title>
		<link>https://susumuishigami.github.io/susumuisinfo/entry/2016/bash_on_windows</link>
					<comments>https://www.susumuis.info/entry/2016/bash_on_windows#respond</comments>
		
		<dc:creator><![CDATA[susumuis]]></dc:creator>
		<pubDate>Fri, 19 Aug 2016 01:38:05 +0000</pubDate>
				<category><![CDATA[未分類]]></category>
		<guid isPermaLink="false">http://www.susumuis.info/?p=1776</guid>

					<description><![CDATA[出遅れてしまいましたが、8月頭に公開されたWindows 10 Anniversary Updateについて、書きます。 目当てはもちろんBash on (Ubuntu on) Windows 他にも色々変わっているよう [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>出遅れてしまいましたが、8月頭に公開されたWindows 10 Anniversary Updateについて、書きます。</p>

<h2>目当てはもちろんBash on (Ubuntu on) Windows</h2>

<p>他にも色々変わっているようですが、僕はこのためにアップデートしたんだと言うくらい、この機能に期待していました。導入の仕方はこの辺りを参考にすると良いと思います。</p>

<p><a href="http://qiita.com/Aruneko/items/c79810b0b015bebf30bb">http://qiita.com/Aruneko/items/c79810b0b015bebf30bb</a></p>

<h2>僕が入れてみたもの</h2>

<h3>ssh</h3>

<p>標準のターミナルがCommand Promptで、日本語とかがうまく表示されなかったりするので、とりあえず、これを入れて、PuttyとかPoderosaでアクセスしたい！こんなことせずにmsys2やcygwinみたいにminttyでアクセスできると良いんだけどね。</p>

<p><a href="http://qiita.com/ubnt_intrepid/items/84a56a01cf7081401917">http://qiita.com/ubnt_intrepid/items/84a56a01cf7081401917</a></p>

<p>こちらの記事では、/etc/ssh/sshd_configに以下の表記が必要ということだったけど、<code>PasswordAuthentication yes</code>は不要で、ちゃんと鍵認証できました。</p>

<pre><code>UsePrivilegeSeparation no
PasswordAuthentication yes
</code></pre>

<h3>LAMP環境</h3>

<p>まあ、王道的使い方の一つというか、Web開発するときに、マカーたちがローカルに環境をホイホイ立ててる間にWindowsっ子は（Windows版で環境を立てると微妙に違って動かないとか言われて）仮想マシンをセットアップしなければならなかったことがなくなるのは良いですね！</p>

<pre><code class="language-sh">$ sudo apt-get install php5 php5-mysql mysql-server
$ php -S localhost:8000
</code></pre>

<p>これでローカル8000ポートでPHPが動くことを確認できました。</p>

<p>ただ、MySQL部分だけはWindows版を動かしたほうが早いかも！</p>

<h3>PHP7</h3>

<p>Bash on Windows のUbuntuは14.04 LTS準拠らしいです。ちょっと古いですよね！PHPも5が標準のようです。</p>

<p>次の記事を見ると、16.04にすることもできるみたいですが、あまりテストされていないだろうと考えると怖いので、あくまで14.04の範囲で頑張ろうと思います。</p>

<p><a href="http://qiita.com/Aruneko/items/2670f42d36a7508c13bb">http://qiita.com/Aruneko/items/2670f42d36a7508c13bb</a></p>

<p>せっかくならPHP7を入れてみましょう。</p>

<pre><code class="language-sh">$ sudo add-apt-repository ppa:ondrej/php
$ sudo ape-get install php7.0
</code></pre>

<p>まあ、普通に入りました。</p>

<h3>node環境</h3>

<p>これこそやりたいことですよね！今時npmをまともに使えないWindowsは取り残されてた感満載でした！</p>

<p>ただ、</p>

<pre><code class="language-sh">$ apt-get install nodejs
</code></pre>

<p>で入るnodejsは古いので、使ってはいけないようです。。<br />
最初これをやってしまってハマりました！</p>

<p>次の記事などを参考にして最新版のnodeをインストールすれば、npmなども最近の記事に書かれているとおりに動きました。</p>

<p><a href="http://qiita.com/TsutomuNakamura/items/7a8362efefde6bc3c68b">http://qiita.com/TsutomuNakamura/items/7a8362efefde6bc3c68b</a></p>

<pre><code class="language-sh">$ sudo curl -sL https://deb.nodesource.com/setup | sudo bash -
$ sudo apt-get install nodejs
</code></pre>

<p>ただ、現時点でnodejs, npm界隈は流動性が激しく、ほんの半年前の記事に従って操作しても、書き方が変わっていたりして思ったように動かなかったりしました。</p>

<p>とはいえ、これはWindowsの問題じゃない</p>

<h3>HHVM, mariadb</h3>

<p>PHP7、mysql5.6が動けば別に構わないのですが、せっかくなので、HHVM, Maria DBの組み合わせも動くかどうかやってみました。</p>

<p>結論としては動きました(^o^;)</p>

<p>やり方は、僕の記事が良いのではないでしょうか？</p>

<p><a href="http://www.susumuis.info/entry/2014/06/11/222935">http://www.susumuis.info/entry/2014/06/11/222935</a></p>

<p>この上で、WordPressなんかもすんなりと動いてしまいました！</p>

<p>せっかくなので、一時的にポートを開けて外部からアクセスしてみて速いかどうかテストしてみましたが、同じWindows上のHyper Vで動かしているHHVM + MariaDBなWordPressの方が速かったです！</p>

<h3>SSH for WindowsからBash</h3>

<p>今の状態では、Bash on Windowsはあくまで開発者用で、サーバー向けではありませんから、Bashウィンドウを開かないとSSHなどができません！</p>

<p>自宅サーバーのメンテナンスに、リモートデスクトップを使っていますが、スピードの遅いモバイル回線ではこれはきついので、SSHできたら便利です。</p>

<p>一応、SSH for Windowsというのはありますが、リモート越しにコマンドプロンプトになるので、あんまり嬉しくない。（Power Shellとか使いこなせると良いらしいですが。。。）</p>

<p>そこで、SSH for Windowsごしにbashとコマンドを打って、Bashに切り替えられたら便利だなーと思ってやってみたのですが、どうもこれはダメみたいです。</p>

<h2>総評</h2>

<p>他の方のブログを見させていただいたところによると、Docker動かそうとして動かない。Oracle JavaやOpen JDK動かそうとして動かないなど、色々と動かないものもあるようです。</p>

<p>しかし、とはいっても、　Ubuntuなのが良いです！Ubuntu向けのWebの記事のまんまやって大体動きます！HHVMは長いことMac用のバイナリがリリースされていなかったので、場合によってはかえってWindowsの方がネイティブ環境を立てやすいということになるかもしれません！</p>

<p>今時、Linuxを使うといっても、ソースからビルドして環境を建てられる猛者はあまりおらず、aptやyumなどのコマンドラインで解決するのがほとんどです。ああ、僕が欲しかったのはLinuxではなく、Ubuntu（またはDebian)だったのか〜と痛感しました。</p>

<p>ただ、ターミナルで日本語が欠けて表示されてしまうなど、不完全なところも多い部分は今後に期待です。</p>

<p>また、「開発者モード」にしないとインストールできないので、現場によっては、「開発者モード」への設定が禁止されて使うことができないかもしれません。あと、タブレットでよく使われている32bit版Windows版には提供されていないようです。</p>

<p>そう言った、もろもろのことを考えると、Windowsでcurlやgrepなどのコマンドラインが欲しいという用途では、<a href="https://msys2.github.io/">msys2</a> が現状では最適のように思います。</p>

<p>しかし、なんといってもUbuntuということで、今後に期待したいと思います！</p>
]]></content:encoded>
					
					<wfw:commentRss>https://www.susumuis.info/?feed=rss2&#038;p=1776</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Javaでオブジェクトを使いこなすために知っておくべきこと – メイドさんでも分かるプログラミングシリーズ vol.2</title>
		<link>https://susumuishigami.github.io/susumuisinfo/entry/2016/java_object_technic</link>
					<comments>https://www.susumuis.info/entry/2016/java_object_technic#respond</comments>
		
		<dc:creator><![CDATA[susumuis]]></dc:creator>
		<pubDate>Sat, 02 Jan 2016 13:46:10 +0000</pubDate>
				<category><![CDATA[メイドさんでも分かるプログラミング]]></category>
		<category><![CDATA[未分類]]></category>
		<guid isPermaLink="false">http://www.susumuis.info/?p=1709</guid>

					<description><![CDATA[前回に引き続き、メイドさんにプログラミングを教えるためのシリーズです。 前回「オブジェクトの多態性ができると便利です」と説明しました。今回は、なぜ便利なのか分かるように、プログラミングでよく使われるテクニックを6つ紹介し [&#8230;]]]></description>
										<content:encoded><![CDATA[<p><a href="http://www.susumuis.info/2015/class_interface">前回</a>に引き続き、メイドさんにプログラミングを教えるためのシリーズです。</p>

<p>前回「オブジェクトの多態性ができると便利です」と説明しました。今回は、なぜ便利なのか分かるように、プログラミングでよく使われるテクニックを6つ紹介したいと思います。</p>

<p>これらを知ることが出来ればオブジェクト指向のメリットを理解出来るだけでなく、実践でプログラミングをしているプログラマーと、かなりコアな会話ができるようになりますよ！</p>

<h2>その1: 関数オブジェクト</h2>

<p>プログラムをしていると「何か起きた時に、この関数を実行して欲しい」という時が良くあります。このような、ある条件の時に実行してもらう関数のことを「コールバック関数」と呼びます。</p>

<p>Javaはメソッドを変数や関数のパラメータに代入することができませんので、こういう時、コールバックして欲しい処理を書いたメソッドを持つオブジェクトを作って、それを渡します。</p>

<p>このようなオブジェクトのことを関数オブジェクトと呼びます。</p>

<p>例えば、架空のクラスですが、WebClientというWebサーバーに通信をして、通信が成功した時に行う処理を指定できるようになっているとします。WebClientResponseCallBackというインターフェース</p>

<pre><code class="language-java">webClient.connect(new WebClientResponseCallBack() {
    @Override
    public void onSucceeded(int status, String result) {
        System.out.println("成功しました");
        System.out.println(status);
        System.out.println(result);
    }
    @Override
    public void onFailed(String result) {
        System.out.println("失敗しました");
        System.out.println(status);    
        System.out.println(result);
    }
});
</code></pre>

<p>これは架空のコードですが、このようなスタイルのライブラリはたくさんありますので、慣れておきましょう。</p>

<p>※<code>@Override</code>という記号が初めて登場しました。これはアノテーションと言うもので、プログラムにつける印です。様々な場面で使用しますが、<code>@Override</code>アノテーションは、継承してメソッドを上書きしていることを示すものです。必須ではないため前回は省略しましたが、付けないとコンパイラ警告が出てしまいますので、今回からは付けることとします。</p>

<p><a href="http://www.susumuis.info/wp-content/uploads/2016/01/aea90ac086e5e9982cc6bcd65768b84e.png"><img loading="lazy" decoding="async" src="http://www.susumuis.info/wp-content/uploads/2016/01/aea90ac086e5e9982cc6bcd65768b84e.png" alt="関数オブジェクト" width="937" height="527" class="alignnone size-full wp-image-1740" srcset="https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2016/01/aea90ac086e5e9982cc6bcd65768b84e.png 937w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2016/01/aea90ac086e5e9982cc6bcd65768b84e-300x169.png 300w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2016/01/aea90ac086e5e9982cc6bcd65768b84e-624x351.png 624w" sizes="(max-width: 937px) 100vw, 937px" /></a></p>

<h2>その2: Template Method パターン</h2>

<p>関数オブジェクトと似たような用途として、クラス継承を活用して、処理を記述する方法もあります。</p>

<p>これも、架空のクラスですが、例えば、画面があって、OKボタンを押した時に何が起こるかはプログラミングできるようになっているライブラリが合ったとします。</p>

<pre><code class="language-java">SampleScreen s = new SampleScreen() {
    public onClickOkButton() {
        System.out.println("ボタンが押された！！");
    }
};
s.show();
</code></pre>

<p>このような、クラス継承を利用して、一部分のメソッドだけサブクラスに委ねるテクニックを、Template Method パターンと呼びます。</p>

<p><a href="http://www.susumuis.info/wp-content/uploads/2016/01/435a1daf9aa31294d6804c218671374b.png"><img loading="lazy" decoding="async" src="http://www.susumuis.info/wp-content/uploads/2016/01/435a1daf9aa31294d6804c218671374b.png" alt="テンプレートメソッド" width="604" height="448" class="alignnone size-full wp-image-1741" srcset="https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2016/01/435a1daf9aa31294d6804c218671374b.png 604w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2016/01/435a1daf9aa31294d6804c218671374b-300x223.png 300w" sizes="(max-width: 604px) 100vw, 604px" /></a></p>

<h2>その3: ラッパーオブジェクトパターン</h2>

<p>例えば、以下のコードは今まで「おまじないです」と言われていたと思います。</p>

<pre><code class="language-java">BufferedReader reader = new BufferedReader(new FileReader("data.dat"));
</code></pre>

<p>これは、<code>FileReader</code>というクラスを<code>BufferedReader</code>クラスが包みこんでいます。BufferedReaderのような、内部にオブジェクトを包み込むオブジェクトのことを「ラッパー（Wrapper）オブジェクト」と呼びます。楽器のラッパじゃないですよ。●ランラップのラップです！</p>

<p>FileReaderは、ファイルを読み込むことができますが、バッファリングの機能はありません。一方、BufferedReaderはバッファリングの機能はありますが、自らファイルを読み込む機能はありません。</p>

<p>そこで、BufferedReaderでFileReaderを包み込むことによって、バッファリングしながらファイルを読み込むことを実現しています。</p>

<p>どんなにオブジェクトを包み込んでいても、外側から見ると内側は隠蔽されています。そして、インターフェースさえ一致していれば、内側に入れるものを切り替えてもプログラムが動きます。</p>

<pre><code class="language-java">BufferedReader reader = new BufferedReader(new InputStreamReader(System.in);
</code></pre>

<p>どんなときに、ラッパーオブジェクトを作るのでしょうか？主に次のようなとき作られます。</p>

<ul>
<li>内側のクラスのインターフェースを変換して、別のインターフェースとしてAPIに渡す</li>
<li>内側のクラスの動作に付加機能を付け加える</li>
</ul>

<p>このように、ラッパーオブジェクトはプログラムをとても柔軟にするテクニックです。</p>

<p><a href="http://www.susumuis.info/wp-content/uploads/2016/01/04c78654c9727817da2678516cf984bd.png"><img loading="lazy" decoding="async" src="http://www.susumuis.info/wp-content/uploads/2016/01/04c78654c9727817da2678516cf984bd.png" alt="ラッパーオブジェクト" width="711" height="442" class="alignnone size-full wp-image-1743" srcset="https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2016/01/04c78654c9727817da2678516cf984bd.png 711w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2016/01/04c78654c9727817da2678516cf984bd-300x186.png 300w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2016/01/04c78654c9727817da2678516cf984bd-624x388.png 624w" sizes="(max-width: 711px) 100vw, 711px" /></a></p>

<h2>その4: Factory</h2>

<p>クラスからインスタンスを作るとき、</p>

<pre><code class="language-java">new クラス名();
</code></pre>

<p>と書くと説明してきました。しかし、オブジェクト指向の世界で、<code>new</code>はわりと嫌われ者です。何故かと言うと、これまでのテクニックの真髄はクラスを切り替えることにあります。</p>

<pre><code class="language-java">SoundsMaker s = new Cat();
s.makeSounds(); // ニャー
</code></pre>

<pre><code class="language-java">SoundsMaker s = new Dog();
s.makeSounds(); // わん
</code></pre>

<p>せっかく<code>SoundsMaker</code>インターフェースを抽出しているのに、プログラムの中に <code>new</code> があるため、動作が決定してしまいるのが良くないとされます。</p>

<p>そこで、newをなるべく隠蔽しようと言うテクニックとしてFactoryパターンというものがあります。</p>

<p>例えば、newを直接書かず、メソッドにしてしまうアイデア</p>

<pre><code class="language-java">public static SoundsMaker getSoundsMaker(String name) {
    if ("tama".equals(name)) {
        return new Cat();
    }
    if ("pochi".equals(name)) {
        return new Dog();
    }
    return null;
}
</code></pre>

<pre><code class="language-java">SoundsMaker s = getSoundsMaker("tama");
s.makeSounds(); // ニャー
</code></pre>

<pre><code class="language-java">SoundsMaker s = getSoundsMaker("pochi");
s.makeSounds(); // ワン
</code></pre>

<p>getSoundsMakerのプログラムを見なかったとしたら、呼び出し元は何のインスタンスが作られるか分かりません。しかし、そんなことを知らなくても、SoundsMakerインターフェースであることは保証されているので、その範囲でできることは安心して使うことができます。</p>

<p><a href="http://www.susumuis.info/wp-content/uploads/2016/01/c81b47f255963cad5d8b193f6b47bb82.png"><img loading="lazy" decoding="async" src="http://www.susumuis.info/wp-content/uploads/2016/01/c81b47f255963cad5d8b193f6b47bb82.png" alt="ファクトリー" width="711" height="442" class="alignnone size-full wp-image-1744" srcset="https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2016/01/c81b47f255963cad5d8b193f6b47bb82.png 711w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2016/01/c81b47f255963cad5d8b193f6b47bb82-300x186.png 300w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2016/01/c81b47f255963cad5d8b193f6b47bb82-624x388.png 624w" sizes="(max-width: 711px) 100vw, 711px" /></a></p>

<h2>その5: MVCモデル</h2>

<p>これは考え方であって、コード例はありません。ざっと覚えておいてください。</p>

<p>一般的に比較的大きなプログラムを書くときは、次のように分割すると良いと言われています。</p>

<table>
<thead>
<tr>
  <th></th>
  <th>役割</th>
</tr>
</thead>
<tbody>
<tr>
  <td>モデル</td>
  <td>ロジックを担当</td>
</tr>
<tr>
  <td>ビュー</td>
  <td>表示を担当</td>
</tr>
<tr>
  <td>コントローラ</td>
  <td>ユーザーの操作に応答し、モデル・ビューを操作する</td>
</tr>
</tbody>
</table>

<p>例えばAndroidで言えば、Activityクラスはコントローラです。もしActivityに全部のプログラムを書いてしまうと、だんだん巨大になってしまいますので、必要に応じて、モデルを切り出すと全体の見通しが良くなります。</p>

<p>ビューは、レイアウトの部分で、同じActivityに異なるレイアウトファイルを与えても動く点でAndroidはビューとコントローラについて抽象化されていると言えます。</p>

<p><a href="http://www.susumuis.info/wp-content/uploads/2016/01/c39dc0080b2a1aee4c3c11c8919f87ae.png"><img loading="lazy" decoding="async" src="http://www.susumuis.info/wp-content/uploads/2016/01/c39dc0080b2a1aee4c3c11c8919f87ae.png" alt="MVCモデル" width="711" height="442" class="alignnone size-full wp-image-1745" srcset="https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2016/01/c39dc0080b2a1aee4c3c11c8919f87ae.png 711w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2016/01/c39dc0080b2a1aee4c3c11c8919f87ae-300x186.png 300w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2016/01/c39dc0080b2a1aee4c3c11c8919f87ae-624x388.png 624w" sizes="(max-width: 711px) 100vw, 711px" /></a></p>

<h2>その6: モックオブジェクト</h2>

<p>最後に、モックオブジェクトについて説明します。</p>

<p>「モック」：モックアップ（mock up）とは、店頭にある展示用模型のことです。本物ではありませんが、本物のような見かけをしています。</p>

<p>プログラムを作っていると、「Aというオブジェクトを使用するにはBというオブジェクトが必要」「Bというオブジェクトの初期化にはCという情報が必要」「CはAndroid実機じゃないと取得できない」などのように、芋づる式に、あらゆるオブジェクトがからみ合ってくることがあります。</p>

<p>しまいには、非常に大きなオバケのような存在になってしまい、一箇所変更すると、どこに影響するのか全然わからなくなることがあります。</p>

<p>この問題を回避するために、本物ではない、仮のオブジェクトを作って動作確認を行うというテクニックが行われます。</p>

<p>そのためのオブジェクトを「モック」あるいは「スタブ」と呼びます。スタブとは「代用品」という意味です。切り株が原義のようです。</p>

<p>インターフェースを使ってプログラミングがされている場合は、比較的カンタンにモックを作ることが出来ます。</p>

<pre><code class="language-java">interface SoundsMaker {
    void makeSounds();
}
</code></pre>

<p>お馴染みのこのインターフェース。実は今アナタはゲームを作っていて、そのゲームでは音を扱っているとします。そこではSoundsMakerインターフェースを継承したオブジェクトがmakeSoundsとやると実際にスピーカーから音が鳴るのです。</p>

<pre><code class="language-java">class Bomb implements SoundsMaker {
    void makeSounds() {
        // 複雑なプログラム
        // 結果的にスピーカーから音が鳴る
        // 「ドカーン！！」        
    }
}
</code></pre>

<p>しかし、Bombクラスを動かすためには、どうやら専用のハードウェアがないといけないそうです。</p>

<p>でも、音を鳴らす以外の部分は、どうやら普通のパソコンでも動かせるみたいです。</p>

<p>そんな時は、モックオブジェクトの出番です。</p>

<pre><code class="language-java">class BombMock implements SoundsMaker {
    void makeSounds() {
        System.out.println("ドカーン！");
    }
}
</code></pre>

<p>Bombクラスの代わりにBombMockクラスを使用するように切り替えれば、特殊なハードウェアがなくても、プログラムが動くようになります。その代わり、音が鳴るタイミングで音はならず、代わりに</p>

<pre><code>ドカーン！
</code></pre>

<p>という文字が出力されます。</p>

<p>本物のオブジェクトとモックの切り替えは、オブジェクトインスタンスをnewで生成するところで行わなければなりません。そのためには「その4」で説明した、「ファクトリー」を使用する検討が必要になってきます。</p>

<p><a href="http://www.susumuis.info/wp-content/uploads/2016/01/519c3352eb4cceca1630f17942944e15.png"><img loading="lazy" decoding="async" src="http://www.susumuis.info/wp-content/uploads/2016/01/519c3352eb4cceca1630f17942944e15.png" alt="モックオブジェクト" width="711" height="442" class="alignnone size-full wp-image-1746" srcset="https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2016/01/519c3352eb4cceca1630f17942944e15.png 711w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2016/01/519c3352eb4cceca1630f17942944e15-300x186.png 300w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2016/01/519c3352eb4cceca1630f17942944e15-624x388.png 624w" sizes="(max-width: 711px) 100vw, 711px" /></a></p>

<h2>まとめ</h2>

<p>今回説明したテクニックを使う、プログラムからどんどん野暮ったさが消えて洗練されて来ていると思いませんか？</p>

<p>しかし、洗練し過ぎも問題です。</p>

<p>例えば、Factoryの説明で作った次のコードは</p>

<pre><code class="language-java">SoundsMaker s = getSoundsMaker()
s.makeSounds();
</code></pre>

<p>元の</p>

<pre><code class="language-java">Cat tama = new Cat();
tama.mew();
</code></pre>

<p>だった時のほうが、垢抜けない可愛さがあります。</p>

<p>洗練されたプログラムというのは、高貴でお近づきにくい存在なのです。より多くのことを知らないと読めないし、知っていてもどんな動きをするのか「実行するまで分からない」ときます。</p>

<p>どこまで洗練すれば良いかは、作っているプログラム次第です。一般的に大きなプログラムは、より洗練されていることが求められますが、個人で作るアプリでは、あどけない感じで作ったほうが正解だったりします。</p>

<p>この感覚は、実際にアプリを作って行くことで培われていきますので、実践で身につけて行ってください。</p>
]]></content:encoded>
					
					<wfw:commentRss>https://www.susumuis.info/?feed=rss2&#038;p=1709</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>MayaaでWebサイトのビューを実装するときに押さえておくべき基本テクニック3 – m:idを減らすテクニック</title>
		<link>https://susumuishigami.github.io/susumuisinfo/entry/2015/mayaa_advent5</link>
					<comments>https://www.susumuis.info/entry/2015/mayaa_advent5#respond</comments>
		
		<dc:creator><![CDATA[susumuis]]></dc:creator>
		<pubDate>Sat, 05 Dec 2015 13:55:23 +0000</pubDate>
				<category><![CDATA[Java]]></category>
		<category><![CDATA[Mayaa]]></category>
		<category><![CDATA[Web技術]]></category>
		<category><![CDATA[未分類]]></category>
		<guid isPermaLink="false">http://www.susumuis.info/?p=1427</guid>

					<description><![CDATA[これは Mayaa Advent Calendar 2015 の5日目です。昨日は「MayaaでWebサイトのビューを実装するときに押さえておくべき基本テクニック2 – m:idの実装における注意点」でした。 ふう、今日 [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>これは <a href="http://qiita.com/advent-calendar/2015/mayaa">Mayaa Advent Calendar 2015</a> の5日目です。昨日は<!--[@susumuis](https://twitter.com/susumuis) さんの-->「<a href="http://www.susumuis.info/entry/2015/mayaa_advent4">MayaaでWebサイトのビューを実装するときに押さえておくべき基本テクニック2 – m:idの実装における注意点</a>」でした。<!--、明日は [@susumuis](https://twitter.com/susumuis) さんの「[](http://www.susumuis.info/entry/2015/mayaa_advent6)」です。--></p>

<p>ふう、今日で5日目ですか。25日書き続けるのが不安になってきました。でも、おかげさまで、いつもよりも多くの方に読んでいただいているようです。出来る限り途切れさせないように頑張ります。</p>

<p>今日は何を書きましょうかね。困ったときは<a href="http://www.susumuis.info/entry/20110708/p1">過去記事</a>の焼き直し...全く同じでも仕方がないですが、ここに書いていることでまだ書いていないことを今日は書きます。</p>

<h2>いしがみメソッド3. m:idを減らすテクニック</h2>

<p>mayaaファイルはxmlなので、サイズが大きくなると、XMLエディタが重くなったりします。なので、なるべくなら、m:idは減らしたいと思ってきます。</p>

<h3>1.m:idをパラメータ対応にする</h3>

<p>m:idを減らすテクニックとして、同じようなメソッドをパラメータ化すればまとめられることが良く有ります。</p>

<p>そんな時は、こんな関数を作りましょう。</p>

<pre><code class="language-javascript">function $p(name, defaultValue) {
    var attr = originalNode.getAttribute(
        Packages.org.seasar.mayaa.impl.engine.specification.SpecificationUtil.createQName(name)
    );
    if (attr != null) return attr.value;
    attr = originalNode.getAttribute(
        Packages.org.seasar.mayaa.impl.engine.specification.SpecificationUtil.createQName(originalNode.getDefaultNamespaceURI(), name)
    );
    return defaultValue;
}
</code></pre>

<p>使い方はこんな感じです。例えば<br />
<a href="http://www.susumuis.info/entry/2015/mayaa_advent3">一昨日書いた</a>forプロセッサーの件は</p>

<pre><code class="language-markup">&lt;m:for m:id="LOOP_ITEM" init="${var loopItemIndex = 0;}" test="${loopItemIndex &amp;gt; items.size() &amp;amp;&amp;amp; loopItemIndex &amp;gt; toInt($p('max'), 999999)}" max="999999"&gt;
  &lt;m:echo&gt;
    &lt;m:doBody /&gt;
  &lt;/m:echo&gt;
&lt;/m:for&gt;
</code></pre>

<p>事前に次の関数を<a href="http://mayaa.seasar.org/documentation/implicit_object.html#functions">load関数</a>で読み込む外部jsファイルなどで読み込んでおいたとします。</p>

<pre><code class="language-javascript">function toInt(s, default) {
  try {
    return java.lang.Integer.parseInt(s);
  } catch (e) {
    return default;
  }
}
</code></pre>

<p>使うときはこんな感じに出来ます。</p>

<pre><code class="language-markup">&lt;div m:id="LOOP_ITEM" m:max="10"&gt;
  ...
&lt;/div&gt;
</code></pre>

<p>このようにすることで、最初の10件のみを表示することができます。</p>

<p>この他にも、m:ifプロセッサーに対して常に条件を逆にするパラメータを作って、逆条件のためのm:id発行を減らすこともできます。（僕はそのためにプロセッサーを作ったりします。プロセッサーの独自作成については、後日説明します。）</p>

<h3>PathAdjusterを効果的に使う</h3>

<p>PathAdjusterは、画像などの相対パスを自動調整して、サーバー実行時に絶対パスに変換する機能です。本来はjpgなどの画像やjsファイルなどに使うものですが、独自のロジックを追加して、リンク先のURLをいい具合に変換すると、単なるリンクではわざわざm:idを発行しなくても良くなることが有ります。</p>

<p><a href="http://mayaa.seasar.org/documentation/path_adjust_settings.html">公式マニュアル - 5-9. パス自動調整の設定</a> を参照してパス自動調整機能をカスタマイズしましょう。</p>

<pre><code class="language-markup">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE provider
    PUBLIC "-//The Seasar Foundation//DTD Mayaa Provider 1.0//EN"
    "http://mayaa.seasar.org/dtd/mayaa-provider_1_0.dtd"&gt;
&lt;provider&gt;
    &lt;pathAdjuster class="jp.example.MyPathAdjuster"&gt;
        &lt;parameter name="enabled" value="true"/&gt;
        &lt;parameter name="force" value="false"/&gt;&lt;!-- since 1.1.13 --&gt;
    &lt;/pathAdjuster&gt;
&lt;/provider&gt;
</code></pre>

<p>そして、jp.example.MyPathAdjuster を作成しておきます。</p>

<pre><code class="language-java">package jp.example;
import org.seasar.mayaa.impl.builder.PathAdjusterImpl;
public class MyPathAdjuster extends PathAdjusterImpl {
  @Override
  public String adjustRelativePath(String base, String path) {
    if (path.endsWith(".html")) {
      return MyConst.SITE_ROOT_URL + "/" + path;
    }
    return super(base, path);
  }
}
</code></pre>

<p>実際のシステムでは色々なパス階層があると思うので、色々工夫してかけると思います。</p>

<p>参考<a href="http://d.hatena.ne.jp/marcie001/20110726/1311679778">PathAdjuster のカスタマイズ - marcie001のメモ</a></p>

<p>以前はPathAdjusterは、この他に、画像のタイムスタンプを出力してキャッシュに使うこともできます。。。などと以前は言っていましたが、ファイルのタイムスタンプをリアルタイムに検索するのも少なからず負荷がかかりますし、最近はcloudfrontなどのCDNを使うことも多かったりします。画像自体別サーバーに置くかもしれません。その辺り、サービスの規模や正確に合わせてください。そんな時も、PathAdjusterがプログラマブルであることが役に立つと思います。</p>

<h2>まとめ</h2>

<p>今回は、m:idを減らすテクニックを紹介しました。ただし、減らし過ぎにも注意してください。あくまで、デザイナーへの使いやすさを前提にしてください。</p>

<p>あまりやり過ぎると、結局混乱を招いてしまいます。こういう暗黙なことをやるときは、事前に説明しておきましょう。</p>
]]></content:encoded>
					
					<wfw:commentRss>https://www.susumuis.info/?feed=rss2&#038;p=1427</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>MayaaでWebサイトのビューを実装するときに押さえておくべき基本テクニック2 – m:idの実装における注意点</title>
		<link>https://susumuishigami.github.io/susumuisinfo/entry/2015/mayaa_advent4</link>
					<comments>https://www.susumuis.info/entry/2015/mayaa_advent4#respond</comments>
		
		<dc:creator><![CDATA[susumuis]]></dc:creator>
		<pubDate>Fri, 04 Dec 2015 13:55:10 +0000</pubDate>
				<category><![CDATA[Java]]></category>
		<category><![CDATA[Mayaa]]></category>
		<category><![CDATA[Web技術]]></category>
		<category><![CDATA[未分類]]></category>
		<guid isPermaLink="false">http://www.susumuis.info/?p=1425</guid>

					<description><![CDATA[これは Mayaa Advent Calendar 2015 の4日目です。昨日は「MayaaでWebサイトのビューを実装するときに押さえておくべき基本テクニック1 – タグの命名規則と実装方法」でした。 昨日は、命名規 [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>これは <a href="http://qiita.com/advent-calendar/2015/mayaa">Mayaa Advent Calendar 2015</a> の4日目です。昨日は「<a href="http://www.susumuis.info/entry/2015/mayaa_advent3">MayaaでWebサイトのビューを実装するときに押さえておくべき基本テクニック1 – タグの命名規則と実装方法</a>」でした。<!--、明日は [@susumuis](https://twitter.com/susumuis) さんの「[](http://www.susumuis.info/entry/2015/mayaa_advent5)」です。--></p>

<p>昨日は、命名規則についての注意点を説明しました。今日はそれを軸に、各m:idの実装の仕方の注意点を説明します。</p>

<h2>いしがみメソッド2. m:id実装時の注意すること</h2>

<h3>1. LOOP系のm:idはindexには長い名前を使い、maxを十分に大きな値を設定する</h3>

<p>m:forを使ってfor文ライクなループを作るとき、インデックスの変数はiやjではなく、長い名前をつけることをおすすめします。これは、内側に含めるm:idが使う変数にどのインデックスが利くのかわからなくなってしまうためです。</p>

<p>また、for系のプロセッサーはmax属性で指定した回数以上ループすると、エラーが発生してしまいます。maxのデフォルト値は256ですが、<u>256回制限は簡単に超えてしまいます。</u>256を超えたら出力が止まるのではなく、エラーになるので、max属性を常に10000くらいに指定するべきです。</p>

<pre><code class="language-markup">&lt;m:for m:id="LOOP_ITEM" init="${var loopItemIndex = 0;}" test="${loopItemIndex &amp;lt; items.length;}" after="${loopItemIndex++}" max="10000"
</code></pre>

<p>別途、ユーザーに指定した回数でループを打ち切る機能を作るのがベストです。それにはテンプレート記述者にパラメータを指定される方法が必要ですので、このやり方は今後紹介します。</p>

<h3>2. writeプロセッサーでエスケープを解除するときは全部する</h3>

<p>m:writeプロセッサーは、標準では常に改行・XML特殊文字・ホワイトスペース文字をエスケープします。XSSの心配がない箇所で動的にタグを出力したい場合など、エスケープを解除する場合は</p>

<pre><code class="language-markup">&lt;m:write m:id="INFO_HTML_HERE" escapeXml="false" /&gt;
</code></pre>

<p>のように書けますが、m:idごとにエスケープの設定が変わると混乱を招きます。<br />
ので、3種類のescapeは全て同時にfalseにしましょう。</p>

<pre><code class="language-markup">&lt;m:write m:id="INFO_HTML_HERE" escapeXml="false" escapeWhitespace="false" escapeEol="false" /&gt;
</code></pre>

<h3>3. 混乱を招く機能を無効にする</h3>

<p>Mayaaの標準設定では、m:id属性ではなく、id属性でもプロセッサーと紐付けられるようになっていますが、デザイナーと分業をする際に混乱を招くため無効にしましょう。</p>

<p>また、XPath機能は使うべきではありません。<br />
理由としては、デザイナーから見て、暗黙の動作のように見えてしまうことがあります。これは後々必ず混乱を招きます。<br />
パフォーマンスにも問題があるので、これも無効にしてしまいましょう。</p>

<p>さらに、m:injectを使ってのプロセッサーの解決も、分業する上では不要な機能なので、無効にするべきです。</p>

<p>よって、次のようになります。</p>

<p>参考: <a href="http://mayaa.seasar.org/documentation/equals_id_resolver.html">5-6. id属性を無視する</a></p>

<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE provider
    PUBLIC "-//The Seasar Foundation//DTD Mayaa Provider 1.0//EN"
    "http://mayaa.seasar.org/dtd/mayaa-provider_1_0.dtd"&gt;
&lt;provider&gt;
    &lt;templateBuilder
            class="org.seasar.mayaa.impl.builder.TemplateBuilderImpl"&gt;
        &lt;resolver class="org.seasar.mayaa.impl.
                builder.injection.MetaValuesSetter"/&gt;
        &lt;resolver class="org.seasar.mayaa.impl.
                builder.injection.ReplaceSetter"/&gt;
        &lt;resolver class="org.seasar.mayaa.impl.
                builder.injection.RenderedSetter"/&gt;
        &lt;resolver class="org.seasar.mayaa.impl.
                builder.injection.InsertSetter"/&gt;
&lt;!--
        &lt;resolver class="org.seasar.mayaa.impl.
                builder.injection.InjectAttributeInjectionResolver"/&gt;
--&gt;
        &lt;resolver class="org.seasar.mayaa.impl.
                builder.injection.EqualsIDInjectionResolver"&gt;
            &lt;parameter name="reportUnresolvedID" value="true"/&gt;
            &lt;parameter name="reportDuplicatedID" value="true"/&gt;
            &lt;!-- HTMLのidとXHTMLのidを追加しないようコメントアウト
            &lt;parameter name="addAttribute"
                    value="{http://www.w3.org/TR/html4}id"/&gt;
            &lt;parameter name="addAttribute"
                    value="{http://www.w3.org/1999/xhtml}id"/&gt;
            --&gt;
        &lt;/resolver&gt;
&lt;!--
        &lt;resolver class="org.seasar.mayaa.impl.builder.
                injection.XPathMatchesInjectionResolver"/&gt;
--&gt;
        &lt;parameter name="outputTemplateWhitespace" value="true"/&gt;
        &lt;parameter name="outputMayaaWhitespace" value="false"/&gt;
        &lt;parameter name="optimize" value="true"/&gt;
    &lt;/templateBuilder&gt;
&lt;/provider&gt;
</code></pre>

<p>余談ですが、将来ここに、独自のInjectionResolverを追加していくようになればMayaa上級者です！</p>

<h3>4. 名前は英語にこだわらない</h3>

<p>m:idの名前はHTMLタグの属性名として指定します。プログラマーはついメソッドを定義するときのように、英語的な名前付けをしてしまいますが、HTMLファイルが横に長くなってしまって読みづらくなってしまうので、積極的に省略しましょう。</p>

<blockquote>
  <p>IF_IS_MEMBER<br />
  ではなく<br />
  IF_MEMBER<br />
  とします。</p>
</blockquote>

<h3>5. tableタグだけは特別に扱う</h3>

<p><code>table</code>タグはMayaaと相性が悪いタグの一つです。<br />
<code>div</code>タグのように、無限に包むことが出来ず、</p>

<blockquote>
  <p>table > tbody > tr > td<br />
  のように階層構造が決まっているため、例えば、trタグにm:idを既に適用してしまうと、そのtrをある条件にもとづいて出し分けなどが出来ません。</p>
</blockquote>

<p>ダメな例:</p>

<pre class=" language-markup">
<code class=" language-markup" data-language="markup">
&lt;table&gt;
  &lt;tbody&gt;
&lt;div m:id="IF_MEMBER"&gt;
    &lt;tr m:id="ROW1_TAG"&gt;
      &lt;td&gt;aaa&lt;/td&gt;
      &lt;td&gt;bbb&lt;/td&gt;
      &lt;td&gt;ccc&lt;/td&gt;
    &lt;/tr&gt;
&lt;/div>
    &lt;tr m:id="ROW2_TAG"&gt;
      &lt;td&gt;aaa&lt;/td&gt;
      &lt;td&gt;bbb&lt;/td&gt;
      &lt;td&gt;ccc&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
</code></pre>

<p>この書き方は出来ません。divタグをtbodyとtrの間に書くことが出来ないためです。IF_ROW3をm:echoなしのifプロセッサーにして、タグが消えるようにすれば、サーバー側では大丈夫になりますが、テンプレート側で見た時に表示が崩れてしまいます。</p>

<p>そこで、せっかくIF_MEMBERのように流用できるm:idがあったとしても、ROW1_TAGの方に、ifプロセッサーを追加して次のようにしてください。</p>

<pre><code class="language-markup">&lt;m:if m:id="ROW1_TAG" test="${context.isMember()}"&gt;
  &lt;m:echo&gt;
    &lt;m:attribute name="xxx" value="yyy" /&gt;
    &lt;m:doBody /&gt;
  &lt;m:echo&gt;
&lt;/m:if&gt;
</code></pre>

<h2>まとめ</h2>

<p>地味なルールですが、これらを守ることであとあと混乱を防ぐということが効いてきます。</p>

<p>Mayaaはとても汎用的に作られていて、初期状態では、大変ゆるい状態でリリースされている印象を持ちます。</p>

<p>しかし、チームで作業をする場合は例えば、<br />
InjectAttributeInjectionResolver<br />
のようなものは使わず、必要最小限の機能で賄う戦略を取ることが結局効率が良いです。</p>

<p>さらに、次回はもっと面白いテクニックを紹介しようと思います。</p>
]]></content:encoded>
					
					<wfw:commentRss>https://www.susumuis.info/?feed=rss2&#038;p=1425</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>MayaaでWebサイトのビューを実装するときに押さえておくべき基本テクニック1 &#8211; m:idの命名規則と実装方法</title>
		<link>https://susumuishigami.github.io/susumuisinfo/entry/2015/mayaa_advent3</link>
					<comments>https://www.susumuis.info/entry/2015/mayaa_advent3#respond</comments>
		
		<dc:creator><![CDATA[susumuis]]></dc:creator>
		<pubDate>Thu, 03 Dec 2015 13:18:08 +0000</pubDate>
				<category><![CDATA[Java]]></category>
		<category><![CDATA[Mayaa]]></category>
		<category><![CDATA[Web技術]]></category>
		<category><![CDATA[未分類]]></category>
		<guid isPermaLink="false">http://www.susumuis.info/?p=1420</guid>

					<description><![CDATA[これは Mayaa Advent Calendar 2015 の3日目です。昨日は「JSPで書かれたシステムをMayaaに移行する」でした さて前回の記事で、JSPでフロントが書かれたプロジェクトをMayaaに移行する例 [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>これは <a href="http://qiita.com/advent-calendar/2015/mayaa">Mayaa Advent Calendar 2015</a> の3日目です。昨日は「<a href="http://www.susumuis.info/entry/2015/mayaa_advent2">JSPで書かれたシステムをMayaaに移行する</a>」でした<!--で、明日は [@susumuis](https://twitter.com/susumuis) さんの「[](http://www.susumuis.info/entry/2015/mayaa_advent4)」です。--></p>

<p>さて前回の記事で、JSPでフロントが書かれたプロジェクトをMayaaに移行する例を書きました。しかし、実際にWebシステムのビューをすべて実装しようとすると大変です。</p>

<p>そこで、今日から数日に分けて私の経験に基づく、MayaaでWebサイトを実装するテクニックを紹介します。</p>

<p>自分で言うのも恥ずかしいですが、「いしがみメソッド」ってなやつです (^^;</p>

<h2>いしがみメソッド1「命名規則は徹底せよ」</h2>

<p>デザイナーはMayaaファイルを読めません。したがって、m:id一つ一つ何を意味するのか、意思疎通をしておくことが必須です。</p>

<h3>1.m:id含め、プログラム都合の識別子は常に大文字を使う</h3>

<p>Mayaaを使う最大の目的は、デザイナーとプログラマーが平行して、最終的に出力される一つのHTMLを作ることです。</p>

<p>したがって、同時にひとつのHTMLを作ることになります。そうすると、二人して同時にclassを作ってしまったりします。</p>

<p>そこで、プログラマーが書くものは常に大文字、デザイナーが書くものは常に小文字というように、命名規則を分けることを推奨します。</p>

<p>プログラマーが小文字、デザイナーが大文字でも良いですが、制御を扱うm:idが大文字の方が埋もれないメリットが有り、次のようなスタイルが良いです。</p>

<pre><code class="language-markup">&lt;div m:id="IF_MEMBER" class="member_box"&gt;
 ...
&lt;/div&gt;
</code></pre>

<h3>2.m:idのする仕事を4種類に限定する</h3>

<p>僕は発行するm:idを次の4種類に限定しています。</p>

<ul>
<li>*_HERE<br />
<br />
<ul>
<li>その場所に文字列を出力する</li>
</ul></li>
<li>*_TAG<br />
<br />
<ul>
<li>そのタグの属性を変化させたり要素を足したりする</li>
</ul></li>
<li>IF_*<br />
<br />
<ul>
<li>そのタグ及びその子要素が特定の条件にもとづいて消える</li>
</ul></li>
<li>LOOP_*<br />
<br />
<ul>
<li>そのタグ及びその子要素を特定の条件に基づいて繰り返す</li>
</ul></li>
</ul>

<p>これまでの経験から、この4種類だけでWebサイトは作れ作れます。</p>

<h3>3.それぞれの実装方法</h3>

<p>それぞれ、実装の方法も固定されます。_HEREは、その場に出力されれば良いので、m:writeプロセッサーをそのまま使うのが良いでしょう。</p>

<pre><code class="language-markup">&lt;!-- タイトルを出力します --&gt;
&lt;m:write m:id="TITLE_HERE" value="${page.getTitle()}" /&gt;
</code></pre>

<p>m:writeプロセッサーではなく、m:insertプロセッサーの場合もあります。これらは、デザイン視点から見たら違いがないので、m:idの名前は、常にデザイナー視点で考えてください。</p>

<p>_TAGは主にタグの属性を変更するために使用します。場合によっては、hidden要素の追加にも使います。hiddenはデザインとは関係ない要素なので、テンプレートに記述することはせず、常にm:idで出すべきです。</p>

<p>また、属性はデザイナーが編集する場合もあり、m:idで制御する対象とデザイナーが書いた属性がぶつかると、デザイナー側の記述が無効になってしまいます。そこで、事前にどのm:idがどの属性を制御するのかわかるようにしておきます。<u>classやid属性が変化するやつは特に注意が必要です１</u></p>

<pre><code class="language-markup">&lt;!-- 商品画像を表示します。src属性を制御します --&gt;
&lt;m:echo m:id="ITEM_IMAGE_TAG"&gt;
  &lt;m:attribute name="src" value="${image.getSrc()}" /&gt;
&lt;/m:echo&gt;
</code></pre>

<p>IFのm:idは、そのままm:ifプロセッサーを使ってはいけません。m:ifプロセッサーは、条件にマッチしても、自分のタグを消してしまいます。例えば</p>

<p>ダメな例：</p>

<pre><code class="language-markup">&lt;m:if m:id="IF_MEMBER" test=${context.isMember()} /&gt;
</code></pre>

<pre><code class="language-markup">&lt;div m:id="IF_MEMBER"&gt;
会員限定
&lt;/div&gt;
</code></pre>

<p>↓</p>

<pre><code class="language-markup">会員限定
</code></pre>

<p>このようになってしまうと、テンプレート上ではdivで囲まれて前後が改行されているのに、divが消えて横並びになってしまいます。これではいけませんので。正解は次のように書くことです。</p>

<p>良い例：</p>

<pre><code class="language-markup">&lt;m:if m:id="IF_MEMBER" test=${context.isMember()}&gt;
  &lt;m:echo&gt;&lt;m:doBody /&gt;&lt;/m:echo&gt;
&lt;/m:if&gt;
</code></pre>

<p>LOOPも同じことが言えます。</p>

<p>良い例：</p>

<pre><code class="language-markup">&lt;m:forEach m:id="LOOP_ITEM" items=${items}&gt;
  &lt;m:echo&gt;&lt;m:doBody /&gt;&lt;/m:echo&gt;
&lt;/m:if&gt;
</code></pre>

<h3>4._TAGの運用な慎重に</h3>

<p>これら、4つのルールの中で、*_TAGは唯一汎用的に使うことができます。それは、IFのようにも、_HEREのようにもできます。</p>

<p>このことは、コンポーネント的なm:idを作れる反面、きちんとドキュメントを書かないとデザイナーとの間で混乱を招きます。</p>

<p>例えば、ある時「条件に応じて、display:noneで表示非表示を切り替えられる領域」という意味で「**_AREA_TAG」というものを作りました。<br />
「エリアタグとはなんぞや」<br />
というクレームが上がりました。どうしても、特殊な概念のTAGを作りたければ、事前にネゴっておきましょう。</p>

<p>実際は<em>_INPUT_TAGや、</em>_RADIO_TAG、*_IMAGE_TAGのように指定するべきタグ名と名前を合わせるのが無難な選択です。</p>

<p>ただ、必ずしもタグ名がデザインとシンクロするとも限らないので、この辺りは事前に話し合って決めましょう。</p>

<h3>default.mayaaに書いたm:idには接頭辞"common."を付けよう！ (2015/12/07 追記)</h3>

<p>default.mayaaに書いたm:idはすべてのテンプレートファイルで使えます。これらと各ページ特有のm:idは名前で見分けられるほうが良いです。</p>

<p>ということで、僕は"common."という接頭辞を付けています。</p>

<pre><code class="language-markup">&lt;span m:id="common.SITE_NAME_HERE"&gt;サイト名&lt;/span&gt;
</code></pre>

<h2>まとめ</h2>

<p>ざっと命名規則について、説明させていただきました。</p>

<p>まとめてみると、常に、同じリソースを、プログラマーとデザイナーが同時に書いているということを意識することが大切です。</p>

<p>Mayaaという技術の採用はプログラマー側が引っ張って導入しているものなので、プログラマーは是非自分の範囲以上に、チーム全体のことを考えてm:idの設計を行ってください。</p>

<p>Mayaaの導入で最も重要なのはチームワークです。明日以降もチームワークを支える様々なテクニックを紹介します。</p>
]]></content:encoded>
					
					<wfw:commentRss>https://www.susumuis.info/?feed=rss2&#038;p=1420</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>WindowsでJavaな人に捧げる素敵なスクリプティングツール jrunscriptの使い方</title>
		<link>https://susumuishigami.github.io/susumuisinfo/entry/2015/java_advent3</link>
					<comments>https://www.susumuis.info/entry/2015/java_advent3#respond</comments>
		
		<dc:creator><![CDATA[susumuis]]></dc:creator>
		<pubDate>Wed, 02 Dec 2015 15:00:20 +0000</pubDate>
				<category><![CDATA[Java]]></category>
		<category><![CDATA[Web技術]]></category>
		<category><![CDATA[未分類]]></category>
		<guid isPermaLink="false">http://www.susumuis.info/?p=1443</guid>

					<description><![CDATA[これは Java Advent Calendar 2015 の3日目です。昨日は@kawasima さんの「Webアプリ開発/テストのお供に『WAITT』」で、明日は @akihyro さんです。 もしもLLが使えたなら [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>これは <a href="http://qiita.com/advent-calendar/2015/java">Java Advent Calendar 2015</a> の3日目です。昨日は<a href="https://twitter.com/kawasima">@kawasima</a> さんの「<a href="http://qiita.com/kawasima/items/1d4daed6f980b4bfbee3">Webアプリ開発/テストのお供に『WAITT』</a>」で、明日は <a href="https://twitter.com/akihyro">@akihyro</a> さん<!--の「[](http://)」-->です。</p>

<h2>もしもLLが使えたなら</h2>

<p>業務にWindowsを使用していて、開発言語はもっぱらJava、LLを使えたらかっこいいと思うけど、Windowsだし。。。。Powershellとかよく知らないしでもっぱらサクラエディタ、、、そんな方はいらっしゃいませんか？</p>

<p>僕は、そんなあなたを応援します！なぜなら僕がそうだからです！</p>

<p>僕は大量のファイルを作ったり、複雑なファイル検索をしたいなどのデータ処理に、よくJDK付属のjrunscriptコマンドを使っています。例えば<a href="http://www.susumuis.info/entry/2014/advent_calendar_javaee">この記事</a>でも使っています。</p>

<h2>jrunscriptとは</h2>

<p>jrunscriptはJDK6以上に付属しているコマンドで、JVM上でJavaScriptエンジンを実行することが出来るコマンドラインツールです。cd()やdir()などの若干のシェル的な組み込み関数をバンドルしています。</p>

<p>JavaScriptなら、Web開発を経験していれば、Javaばかりの人も自由に書けるのではないでしょうか？</p>

<h2>Javaプログラマーがjrunscriptコマンドを使いこなすメリット</h2>

<ul>
<li>JDKさえ入っていれば、WindowsでもMacでもLinuxでも動く</li>
<li>使い慣れたJavaAPIが使える</li>
</ul>

<p>冒頭に述べた僕みたいな人にぴったりなツールです。確かに、LLに比べてJavaScriptはfunctionなどの入力量が多いです。</p>

<p>しかし、APIを調べたり、言語仕様を勉強している時間がほぼいらないので、やりたいことが最短で実現できます。</p>

<p>しかも、LinuxやMacにそのまま持っていけます！やった＼(^o^)／</p>

<h2>JVMの状態を見よう</h2>

<p>jrunscriptのもう一つの用途として、即座にJavaのシステムプロパティどうなっているんだっけ？など、JVMの状態をしれてしまうことがあります。</p>

<pre><code>$ jrunscript -e "print(java.lang.System.getProperty('user.timezone'))"
</code></pre>

<p>システムプロパティを列挙するならこんな感じです。</p>

<pre><code>$ jrunscript -e "for (var key in java.lang.System.properties) print(key + "-" + java.lang.System.properties[key]);"
</code></pre>

<h2>組み込み関数を知ろう</h2>

<p>次のURLに記載された関数が組み込まれています。<br />
<a href="http://docs.oracle.com/javase/7/docs/technotes/tools/share/jsdocs/GLOBALS.html">http://docs.oracle.com/javase/7/docs/technotes/tools/share/jsdocs/GLOBALS.html</a></p>

<p>これらの関数は地味ながら、時々役立ちます。例えばjrunscriptで簡単なインストーラーを作るときなどは重宝すると思います。</p>

<h2>JavaとJavaScriptの橋渡し</h2>

<p>JavaAPIを使ってしまうと、Javaの配列を受け取ったりします。Nashorn/Rhinoの世界では、JavaScriptの配列とJavaの配列は明確に区別されており、JavaScriptとして使うならJavaScript配列を使ったほうが便利です。</p>

<p>例えば、次のようにES5風のforEachが書けます。</p>

<pre><code class="language-javascript">nashorn&gt; [1,2,3,4,5].forEach(function(i){print(i);})
1
2
3
4
5
</code></pre>

<p>しかし、Java配列の場合はできません。</p>

<pre><code class="language-javascript">nashorn&gt; new java.io.File(".").list().forEach(function(i){print(i);})
script error: TypeError: [Ljava.lang.String;@5a63f509 has no such function "forEach" in &lt;STDIN&gt; at line number 1
</code></pre>

<p>この場合は、<code>Java.from</code>というメソッドが使えます。</p>

<pre><code class="language-javascript">nashorn&gt; Java.from(new java.io.File(".").list()).forEach(function(i){print(i);})
aaa.txt
bbb.js
xxx.zip
</code></pre>

<h2>応用編</h2>

<h3>あるディレクトリ以下の全てのファイルを探索</h3>

<p>これはよく使うのでイデオムではないでしょうか。</p>

<pre><code class="language-javascript">function f(i) {
    if (i.isDirectory()) {
        Java.from(i.listFiles()).forEach(function(e) {f(e);})
    } else { doSomething(i) }
}
doSomething = function(i) {print(i);};
f(new java.io.File("."));
</code></pre>

<p>以下、このfを定義していたとします。</p>

<h3>例題1. あるディレクトリ以下で、拡張子がjavaのファイルで10日以内に変更したファイル一覧を取得</h3>

<pre><code class="language-javascript">doSomething = function(i) {
    if (i.lastModified() &gt; java.lang.System.currentTimeMills() - 1000 * 3600 * 24 * 10) {print(i);}};
f(new java.io.File("."));
</code></pre>

<h3>例題2. あるディレクトリ以下で、ファイル名がAdminから始まっているファイルの容量の合計</h3>

<pre><code class="language-javascript">doSomething = function(i) {
    if (i,getName().startsWith("Admin")) {print(i.length()); sum += i.length()}};
var sum = 0; f(new java.io.File(".")); print(sum);
</code></pre>

<p>例題として微妙ではありますが、関数を組み立ててやりたいことを実現していくのが気持ち良くなってきませんか？</p>

<h2>まとめ</h2>

<p>このように、JDKさえあれば使える、クロスプラットフォームなスクリプティングツールとして、いざというときに役立つのではないでしょうか。</p>

<p>Java6がリリースされてから9年経ちますので、9年前以降のしすてむであったら使うことが出来ます。</p>

<p>JavaAPIが使えるので、いちいち慣れない言語のAPIを調べる手間が省けるのが嬉しいです。あれ、これ、Rubyではどう書くんだろう？と思う必要がありません。</p>

<p>また、ある程度うまく行ったら、Javaで同等なことが出来るので、本番のコードとして流用することもあるかも知れません。</p>

<p>これで、LL弱者の僕も、ワンライナーを駆使できるようになりました。</p>

<p>次はあなたの番です！</p>

<h2>jjsコマンドについて</h2>

<p>jrunscriptの他に、Java8からはjjsというコマンドが搭載されています。jrunscriptは試験的に作られたコマンドという位置づけなので、本来はjjsコマンドを使うべきです。</p>

<p>しかし、標準組み込み関数が微妙に異なることと、java6,7環境も依然として存在すると思われますので、僕はjrunscriptを好んで使います。</p>
]]></content:encoded>
					
					<wfw:commentRss>https://www.susumuis.info/?feed=rss2&#038;p=1443</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>JSPで書かれたシステムをMayaaに移行する</title>
		<link>https://susumuishigami.github.io/susumuisinfo/entry/2015/mayaa_advent2</link>
					<comments>https://www.susumuis.info/entry/2015/mayaa_advent2#respond</comments>
		
		<dc:creator><![CDATA[susumuis]]></dc:creator>
		<pubDate>Tue, 01 Dec 2015 15:00:43 +0000</pubDate>
				<category><![CDATA[Java]]></category>
		<category><![CDATA[Mayaa]]></category>
		<category><![CDATA[Web技術]]></category>
		<category><![CDATA[未分類]]></category>
		<guid isPermaLink="false">http://www.susumuis.info/?p=1416</guid>

					<description><![CDATA[これは Mayaa Advent Calendar 2015 の2日目です。昨日は「Mayaaとの出会い」でした。 JSPで書かれたシステムのMayaaへの移行 さて、前回、MayaaはJSPと同じレイヤーで動いているか [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>これは <a href="http://qiita.com/advent-calendar/2015/mayaa">Mayaa Advent Calendar 2015</a> の2日目です。昨日は「<a href="http://www.susumuis.info/entry/2015/mayaa_advent1">Mayaaとの出会い</a>」でした。<br />
<!--明日は [@susumuis](https://twitter.com/susumuis) さんの「[](http://www.susumuis.info/entry/2015/mayaa_advent3)」です。--></p>

<h2>JSPで書かれたシステムのMayaaへの移行</h2>

<p>さて、前回、MayaaはJSPと同じレイヤーで動いているから、JSPでデザインが描かれているシステムは簡単に移行できると書きました。</p>

<p>今回は実例を元に、その様子を解説しようと思います。</p>

<h2>何でも良いので、JSPをビューに使っているMVCフレームワークがあるとします。</h2>

<p>例えばこれは、SAStrutsのコード例です。</p>

<pre><code class="language-java">import org.seasar.struts.annotation.Execute;
public class IndexAction {
    @Execute(validator = false)
    public String index() {
        return "index.jsp";
    }
}
</code></pre>

<p>今から新規にStrutsのコードを書くことはないと思いますが、StrutsライクなMVCフレームワークなら何でも同じようにできると思います。自分の使っているフレームワークに脳内変換してください。<br />
（後日、最近のメジャーなフレームワークとMayaaを連携する例を書きたいと思います。）</p>

<h2>MayaaServletをweb.xmlに登録</h2>

<p>もし使っているのが、レガシーServletでWeb.xmlを書いているなら、次の設定を書き加えましょう。</p>

<pre><code class="language-markup">    <!-- Mayaaサーブレットの設定 -->
    &lt;servlet&gt;
        &lt;servlet-name&gt;MayaaServlet&lt;/servlet-name&gt;
        &lt;servlet-class&gt;org.seasar.mayaa.impl.MayaaServlet&lt;/servlet-class&gt;
        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
    &lt;/servlet&gt;

    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;MayaaServlet&lt;/servlet-name&gt;
        &lt;url-pattern&gt;*.xhtml&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;
</code></pre>

<p><code>&lt;url-pattern&gt;*.xhtml&lt;/url-pattern&gt;</code>という部分は、標準のMayaaの流儀ではないかもしれません。しかし、多くのWebシステムは既にhtmlをマッピングしているのではないでしょうか？私の現場もそうでした。そこで私はxhtmlファイルをMayaaのテンプレートとして設定しました。その結果、テンプレートファイルは正しいxhtml書式で書く文化がチーム内に浸透したため、良い判断だったと思います。</p>

<p>あとは、Java側でフォワードしている部分のJSPの部分を</p>

<pre><code class="language-java">import org.seasar.struts.annotation.Execute;
public class IndexAction {
    @Execute(validator = false)
    public String index() {
        return "index.xhtml";
    }
}
</code></pre>

<p>のように書き換えましょう。後はindex.jspの代わりにindex.xhtmlを置くだけです。</p>

<p>この方法の良い所は、JSPとMayaaを同居できることです。移行作業中は、古いJSPのテンプレートも残すことが出来ます。ただし、JSPにMayaa、MayaaにJSPをインクルードすることは出来ませんので、そのあたりはご注意ください。</p>

<h2>テンプレートを書く</h2>

<p>次にテンプレートを書きましょう。例えばJSPがあったとします。ちなみに、僕はJSPのtaglibが嫌いで、ほとんど使いません。なので、MayaaにもJSPのtaglibをサポートする機能を持っていますが、全然使ったことがありませんので、公式のマニュアルを参照してください（笑）</p>

<p>ちなみに、EL式も使いません。何か文句ありますか？</p>

<pre><code class="language-markup">&lt;%@ page contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %&gt;
&lt;%@ page import="info.susumuis.sample.ViewHelper" %&gt;
&lt;%@ page import="info.susumuis.sample.SampleBean" %&gt;
&lt;% SampleBean bean = (SampleBean) request.getAttribute("bean"); %&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title &gt;&lt;%= ViewHelper.escape(bean.getTitle()) %&gt; &lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;%= ViewHelper.escape(bean.getMessage()) %&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>ViewHelper.escapeは、HTMLエスケープをする共通メソッドだと思ってください。</p>

<p>これをMayaaに移植する最も手っ取り早い方法は、JSPを実行した結果のHTMLをいきなり貼り付けてしまうことです。</p>

<pre><code class="language-markup">　



&lt;html&gt;
&lt;head&gt;
&lt;title &gt;たいとる&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
ハローワールド
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>このままでは文字化けしてしまいますので、metaタグで文字コードを指定します。Mayaaはmetaタグでコンテントタイプを設定しておくと、勝手にヘッダを書き換えてくれますので活用しましょう。</p>

<p>このとき、注意として、HTML5の、<code>&lt;meta charset=""&gt;</code>を使わないことです。使っても良いのですが、<code>text/html;</code>の部分の情報が抜けてしまうので、以下のように古い書き方を使うことをおすすめします。</p>

<pre><code class="language-html">&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
</code></pre>

<p>また、JSP特有の空行は消していきましょう。また、拡張子をxhtmlファイルにしてしまったので、ブラウザでプレビューできるようにxmlns指定を書きます。本当は先頭行に<?xml ～ ?>宣言が必要ですがこれはサボっても表示できるようです。（この辺りは、MayaaがContent-Typeを見て最終的に適切な出力に調整してくれます）</p>

<pre><code class="language-markup">&lt;!DOCTYPE html&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
&lt;title &gt;たいとる&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
ハローワールド
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>このテンプレートはWebブラウザでそのまま開くことが出来るはずです。</p>

<p>これで、サーバーで実行するのと同じ出力を得ることができますね。</p>

<p>え、動的な部分が固定されてしまっている？その通りです。しかし、Mayaaのページ作りの流儀としてはこれでよいのです。この後の説明を読めば分かります。</p>

<h2>動的部分を実装する</h2>

<p>元のコードはSampleBeanから、タイトルとメッセージを取得していましたね。Mayaaでは動的な出力を実現するために、m:idというものを使います。</p>

<pre><code class="language-markup">&lt;!DOCTYPE html&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml" xmlns:m="http://mayaa.seasar.org"&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
&lt;title m:id="TITLE_TAG"&gt;たいとる&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;span m:id="MESSAGE_HERE"&gt;ハローワールド&lt;/span&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>htmlタグに名前空間<code>xmlns:m</code>を追加しています。<br />
m以外を指定しても動きますが、普通はm:に割り当てます。"m:id"は「エム・アイ・ディー」と読みます。Mayaaの世界では非常に多用する単語なので、覚えましょう。</p>

<p>動的にしたいタグにm:idを加えていきます。もともとタグがなかったところはspanタグで補います。</p>

<p>ところで、Mayaaは非常に柔軟ですが、自由に使い過ぎると、デザイナーさんとの連携をスムーズにできません。お互いにある程度ルールを定めるべきです。そこで、僕はm:idは次の4種類に限定しています。</p>

<ul>
<li>_HERE<br />
<br />
<ul>
<li>その場所に文字列を出力する</li>
</ul></li>
<li>_TAG<br />
<br />
<ul>
<li>そのタグの属性を変化させたり要素を足したりする</li>
</ul></li>
<li>IF_<br />
<br />
<ul>
<li>そのタグ及びその子要素が特定の条件にもとづいて消える</li>
</ul></li>
<li>LOOP_<br />
<br />
<ul>
<li>そのタグ及びその子要素を特定の条件に基づいて繰り返す</li>
</ul></li>
</ul>

<p>m:idを発行するときは、出来る限り、HTMLとしてvalidになるように心がけましょう。<br />
例えば、tableタグの中に、divタグを入れたり、titleタグの中にspanタグを入れるのは無しです。そのようなことをすると、Mayaaの良さを喪失してしまうので気をつけてください。</p>

<p>このままページを出力してみましょう。<br />
ローカルでそのままダブルクリックしてブラウザに表示させても、サーバーで実行させても相変わらず表示は同じです。</p>

<h2>mayaaファイルを書く</h2>

<pre><code class="language-markup"><?xml version="1.0" encoding="UTF-8"?>
&lt;m:mayaa xmlns:m="http://mayaa.seasar.org"&gt;
    &lt;m:beforeRender&gt;
        var bean = request.bean;
    &lt;/m:beforeRender&gt;

    &lt;!-- タイトルタグです --&gt;
    &lt;m:echo m:id="TITLE_TAG"&gt;
        &lt;m:write value="${bean.getTitle()}" /&gt;
    &lt;/m:echo&gt;

    &lt;!-- メッセージを出力します --&gt;
    &lt;m:write m:id="MESSAGE_HERE" value="${bean.getMessage()}" /&gt;
&lt;/m:mayaa&gt;
</code></pre>

<p>このようにm:idの動作を記述していきます。実は命名規則を定めたので、これらの書き方はある程度定型化できます。Mayaaはm:idだけ定義しておいて、mayaaファイルに実装していないとログにエラーメッセージを吐くので、エラーメッセージから雛形を出力するマクロを作るのも良いでしょう。僕も過去に作りました。</p>

<p><a href="http://www.susumuis.info/entry/20110330/p1">Mayaaファイルを命名規則から一括作成するEmEditorマクロ</a></p>

<p>本当は、標準のm:write, m:ifなどは使い勝手が悪いので、自分でプロセッサーを作ることをおすすめします。これについては、後日ご紹介します。</p>

<p>もう一つ、JSPのコードからViewHelper.escapeの記述が消えました。Mayaaでは、出力をエスケープするのがデフォルトの動作です。なので、「必要に応じてエスケープを解除する」というスタイルになります。昨今脆弱性が対策は必須となっていますので、この流儀は大変便利です。</p>

<p>このようにして1ページの移行が完了しました。あとは、全てのページを同じように移行していくことです。</p>

<p>しかし、実際のページはもっと複雑で、難しいことも多いと思います。次回から、個別にハマリポイントとその回避方法を紹介して行こうと思います。</p>
]]></content:encoded>
					
					<wfw:commentRss>https://www.susumuis.info/?feed=rss2&#038;p=1416</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Mayaaとの出会い</title>
		<link>https://susumuishigami.github.io/susumuisinfo/entry/2015/mayaa_advent1</link>
					<comments>https://www.susumuis.info/entry/2015/mayaa_advent1#respond</comments>
		
		<dc:creator><![CDATA[susumuis]]></dc:creator>
		<pubDate>Mon, 30 Nov 2015 15:00:39 +0000</pubDate>
				<category><![CDATA[Java]]></category>
		<category><![CDATA[Mayaa]]></category>
		<category><![CDATA[Web技術]]></category>
		<category><![CDATA[未分類]]></category>
		<guid isPermaLink="false">http://www.susumuis.info/?p=1414</guid>

					<description><![CDATA[これは Mayaa Advent Calendar 2015 の1日目です。 明日は @susumuis の「JSPで書かれたシステムをMayaaに移行する」です。--> 今日からMayaaについての記事を書いていきます [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>これは <a href="http://qiita.com/advent-calendar/2015/mayaa">Mayaa Advent Calendar 2015</a> の1日目です。</p>

<p>明日は <a href="https://twitter.com/susumuis">@susumuis</a> の「<a href="http://www.susumuis.info/entry/2015/mayaa_advent2">JSPで書かれたシステムをMayaaに移行する</a>」です。--></p>

<p>今日からMayaaについての記事を書いていきます。</p>

<h2>Mayaaってなに？</h2>

<p><a href="http://mayaa.seasar.org/">Mayaa</a>はエンジニアとデザイナーとの連携を強く意識して設計されたJavaテンプレートエンジンです。</p>

<p>Mayaaを使用したプロジェクトが上手くいくと、Webデザイナーはプログラムを意識することなく、Webアプリケーションのデザインコーディングをすることができ、プログラマーはHTMLやJSPなどのコーディングから開放されます。</p>

<h2>お前誰？</h2>

<p>初めてこのブログを読んでくれた方には申し遅れました。私は、2009年より、仕事でMayaaを使用していて、2015年よりMayaaコミッターの末席に名を連ねさせていただいたものです。</p>

<p>おそらく、現在私が関わったプロジェクトが、Mayaaを使用した最も大規模なシステムの一つではないかと思っています。なので、どちらかと言うとMayaaの開発者視点というより、ユーザー視点の方が強いです。</p>

<h2>Mayaaとの出会い</h2>

<p>先ほど述べたとおり、2009年に自分の仕事でMayaaを利用し始めました。既にリリースから数年経過していますから、少し遅いほうだと思います。</p>

<p>当時、私は、ECサイトシステム構築におけるプログラミングコストの削減と、デザインテンプレートの充実化を課題として持っていました。</p>

<p>そこではじめはApache Wicketを試してみたのですが、確かにWicketは素晴らしいアーキテクチャでしたが、プログラミングの考え方がガラッと変わりすぎてしまい、既存の資産の活用が困難であるとわかり、導入を見送りました。</p>

<p>Wicket導入を振り出しに戻し、次にMayaaを検討することにしました。当時はまだThymeleafやMixer2はありませんでした。</p>

<h2>Mayaaの導入がうまく行った理由</h2>

<p>嬉しいことにMayaaの導入は非常にスムーズに行きました。それは、Mayaaが、システムの構成上、JSPと同じレイヤーに位置づけられるように設計されているため、他の部分を変える必要が一切なかったことです。</p>

<p>JSPファイルの横にxhtmlファイル（Mayaa標準ではhtmlを推奨していますが、htmlは既にフロントのサブレットに割り当てられていました）を配置して、.jspへフォワードする代わりに、.xhtmlへフォワードするだけで、後は、テンプレートを書くだけで移行が完了してしまいました。</p>

<p><a href="http://www.susumuis.info/wp-content/uploads/2015/12/mayaa_jsp.png"><img loading="lazy" decoding="async" src="http://www.susumuis.info/wp-content/uploads/2015/12/mayaa_jsp.png" alt="mayaa_jsp" width="694" height="409" class="alignnone size-full wp-image-1494" srcset="https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2015/12/mayaa_jsp.png 694w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2015/12/mayaa_jsp-300x177.png 300w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2015/12/mayaa_jsp-624x368.png 624w" sizes="(max-width: 694px) 100vw, 694px" /></a></p>

<p>バックオフィスツールなど、デザインが重視されない部分については従来通りJSPを維持することも可能でした。</p>

<p>このようにアーキテクチャの変更をほとんどすることがなく、JSPから移行ができたことが、最大のメリットだったと思います。</p>

<h2>次回予告</h2>

<p>次回は、JSPで書かれたテンプレートをMayaaによるテンプレートに移行するときの手順、ハマったことなどを書こうと思います。</p>
]]></content:encoded>
					
					<wfw:commentRss>https://www.susumuis.info/?feed=rss2&#038;p=1414</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Seasar Conference 2015に参加してLTをしてきました #seasarcon</title>
		<link>https://susumuishigami.github.io/susumuisinfo/entry/2015/seasarcon</link>
					<comments>https://www.susumuis.info/entry/2015/seasarcon#respond</comments>
		
		<dc:creator><![CDATA[susumuis]]></dc:creator>
		<pubDate>Sun, 27 Sep 2015 13:19:52 +0000</pubDate>
				<category><![CDATA[Java]]></category>
		<category><![CDATA[Mayaa]]></category>
		<category><![CDATA[Web技術]]></category>
		<category><![CDATA[勉強会レポート]]></category>
		<category><![CDATA[未分類]]></category>
		<category><![CDATA[論評]]></category>
		<guid isPermaLink="false">http://www.susumuis.info/?p=1389</guid>

					<description><![CDATA[2015/09/26、5年ぶりに開催された、 Seasar Conference 2015 Not 同窓会 に参加し、次のスライドでLT登壇してきました。 なぜLTをしたのか 僕はこれまでにもMayaa関係の勉強会登壇を [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>2015/09/26、5年ぶりに開催された、<br />
<a href="http://seasar.connpass.com/event/19317/">Seasar Conference 2015 Not 同窓会</a><br />
に参加し、次のスライドでLT登壇してきました。</p>

<iframe loading="lazy" src="http://www.slideshare.net/susumuishigami/slideshelf" width="615px" height="470px" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:none;" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe>

<h2>なぜLTをしたのか</h2>

<p>僕はこれまでにもMayaa関係の勉強会登壇を繰り返してきました。</p>

<p><a href="http://www.susumuis.info/entry/20131111/p1">JJUG CCC 2013 Fall: テンプレートエンジンを利用してプログラマーとWebデザイナーが共同作業をする上で大切なこと</a><br />
<a href="http://www.susumuis.info/entry/20130822/p1">JJUG ナイトセミナー 2013/08: from JSP to Design-friendly Template Endine JSPからMayaaに移行した本当の話</a></p>

<p>このブログでも、Mayaaについての発信が多めです。</p>

<p><a href="http://www.susumuis.info/entry/2014/mayaa_experience">5年間Mayaaを使って思ったこと</a><br />
<a href="http://www.susumuis.info/entry/20120528/p1">Mayaaでm:idの解決の仕方を自分好みにカスタマイズする方法</a><br />
<a href="http://www.susumuis.info/entry/20110918/p1">MayaaなどRhinoを使っていてハマること。It is not a function, it is String</a><br />
<a href="http://www.susumuis.info/entry/20110715/p1">2年間Mayaaを使ってわかったこと その２</a><br />
<a href="http://www.susumuis.info/entry/20110708/p1">そろそろ2年間Mayaa使ってわかったことを書く</a><br />
<a href="http://www.susumuis.info/entry/20110331/p2">MayaaでHTML5のスマートフォンページを作る際にはまったこと</a><br />
<a href="http://www.susumuis.info/entry/20110330/p1">Mayaaファイルを命名規則から一括作成するEmEditorマクロ</a><br />
<a href="http://www.susumuis.info/entry/20090908/1252383862">MayaaでGuice2.0 AOPを使うとうまく動かない件〜解決編</a><br />
<a href="http://www.susumuis.info/entry/20090906/1252210901">MayaaでGuice2.0 AOPを使うとうまく動かない件</a></p>

<p>Mayaaは、自分が大変お世話になっているOSSで、不具合報告などでOSS活動にも関わらせていただくなど、技術者として成長させてもらった思い入れの強いライブラリです。</p>

<p>この日、作者である栗原 傑享さんや、現在メインコミッターを務められる須賀 幸次さんがいらっしゃるということで、彼らへの感謝の気持ちを表現したいという、実に個人的な動機がLTをした理由でした。</p>

<p>それにしては、Seasar Foundationの重鎮の方々に好意的に受け入れて頂いたようです。考えてみるとMayaaが生まれた土壌である、Seasarコミュニティの存在も肯定する内容でもあったからかなと思います。そういったわけでは、Seasarコミュニティーに対しても感謝の気持ちを明確に表すべきでした。この場を持って、感謝の意を表明致します。</p>

<h2>なぜ今SeasarConなのか？</h2>

<p>Seasar Conference は2010年を最後に開催されず、Seasar2も既に機能の追加が中断されていました。既に、JavaのトレンドはSpringやJava EEに移行しており、Seasarは時代の中でフェードアウトしたように見えていました。その中で、なぜ？今 Seasar Conference なのか？と多くの方が興味を持ったと思います。</p>

<p>蓋を開けてみると、5年前まで、あんなに先導的なメッセージを発信して日本のJava系エンジニアの最大のカリスマだったひがやすをさんが、どうも、中立的というか、大人な話し方をされている印象でした。まして、Seasar2のサポート終了（2016/09/26）を宣言される。あれあれ、なんか暗いぞ？？</p>

<p>そこへ栗原 傑享さんの喝が入ります。どどどんな展開((((；ﾟДﾟ))))ｶﾞｸﾌﾞﾙ</p>

<p>5年間Seasar Conferenceが行われなかった裏で何が起きていたかについては、理事長の橋本さんのセッションで説明がありました。開催されなかった理由：</p>

<ul>
<li>イベント駆動開発→開発駆動イベント→DIのメンテナンス終了、ワクワク感より調整の難易度が上回った</li>
<li>NPO運営はスポンサーに支えられている。ムーブメント、流行に乗る必要がある</li>
<li>NPO改名問題があった</li>
</ul>

<p>NPO活動を行うにも、イベント一つ行うのも、裏での苦労が絶えないのだなあということが伝わりました。その一方で、福岡の方では「明星和楽」というイベントが行われ、これは「テクノロジーとクリエイティブ」にフォーカスしたイベントで、業界の流れがSIからスタートアップに向かう中での実験として成功だったそうです。</p>

<p>自分は新参者なので、知りませんでしたが、Seasarコミュニティを支えていた方々は、SIerの精鋭たちが中心であって、SeasarとSI・受託開発という枠組みは切っても切れない存在のようです。2010年頃には、ひがさんはSlim3をリリースしていてAppEngineなどでのスタートアップ志向にシフトしていたし、橋本さんの経営されるヌーラボは、Cacooなどのサービスを打ち出していたので、どちらかと言うと、サービス指向をもともと持っていた人たちだと思っていましたが、SIにおける、エンタープライズJavaからのニーズがSeasarの原点だったのです。</p>

<p>2010年から、2015年の間に震災やスマホブーム、ソシャゲブーム、クラウドの興隆を経て、今時「受託かスタートアップか」という議論自体が古臭いと思いますが、Seasarというコミュニティは、その原点と、その名前が足かせとなって、進むべき方向性に難儀していたそうです。こういうことを赤裸々に話してくれたことに大変感謝します。</p>

<p>個人的には、僕のような、当時接点を持てなかった者がかつてSeasarで有名だった方々と繋がることができたのが大変ありがたく思いました。懇親会にも参加させていただきましたが、これからどうするのかというような議論が活発になされているようです。解散か？改名か？なにかの転換があるのか？Seasarの次の動向に期待したいです。</p>

<h2>栗原さんの海外のIT事情の発表が面白かった</h2>

<p>Mayaaの開発者にして、グルージェントの創業者で、サイオスの幹部として、現在はシリコンバレーに生活されてスタートアップをされている栗原 傑享さんの発表は刺激的でした。</p>

<p>アメリカでは、徹底的に生活の効率化が行われて、公共インフラが民間企業の寡占状態にある。例えば、警察を呼べばお巡りは来ずに、メールアドレスを聞かれて、<a href="https://coplogic.com/">CoplogicというWebサイト</a>から被害届を出すように言われる。そのCoplogicは民間企業！部屋を探すときは<a href="http://www.craigslist.org/about/sites">craigslist</a>が必須。Coplogicもcraigslistもナニコノ垢抜けないデザインは！</p>

<blockquote>
  <p>「少年野球はミスも出やすいですから、基本積極プレーで」（引用：MAJOR 2nd 第25話)</p>
</blockquote>

<p>これがアメリカのスタートアップのメンタルのようです。僕たちは、FacebookやGoogleといった超巨大な企業しか知らないために、すごいイメージがありますが、あれはメジャーリーグ、シリコンバレーのスタートアップは大半が少年野球！（マイナーリーグですらないのか。。。）彼らはCSSも書かずに平気で2塁まで突っ込んでいくんだそうです。</p>

<p>このメンタルでくると、要件定義をして、スケジュールを引いて、アサインして……のやり方では間に合わないのは確かですね。</p>

<p>前述のように、アメリカは公共インフラが徹底的に効率化され、民間企業の寡占状態にあります。この状況は、間違いなく未来の日本にもやってくる！今のうちにcraigslistをパクったら儲かるｗｗｗまあ、100パーセント同じにはならないと思いますが。(^^;</p>

<h2>個人的な考察：2010年から2015年という時代について思うこと</h2>

<p>稚拙な考察ですが、2010年ごろ不況もあり、業務システムのIT化も既にコモディティ化が済んでしまった以降、今までの形態のSIerのニーズは減少し、クラウドなど黒船の到来によって、この世界は縮小するのは明らかでした。</p>

<p>では、多くのITエンジニアが職を失ったのかといえば全く逆で、未だに「エンジニアが足りない」と言っている。何が起きたかといえば、これまでよりも多くのことにWebやスマホなどのITが使われるようになった（リアルなお店でものが売れなくなった）と言われます。</p>

<p>しかし、この業界の流動性は非常に速く、今までみたいにじっくり良い物を作っていくより、手が早い方が求められました。そうすると、1からスクラッチでシステムを作るより、WordPressを改造して目的を実現するとか、既存の何かをいじって楽をできる方が重要で、そうなってくるともう言語やフレームワークがどうこう言っていられない。WordPressに乗っかるのか、Google Appsに乗っかるのか？</p>

<p>ただ乗っかっているだけだとプラットフォーマーに吸い取られる仕組みになっています。そこで自ら何らかのプラットフォーマーになるか、あるいはレベニューシェアなど成果にコミットする方向性がこれから成功する秘訣なのかなあと思います。</p>

<p>そう考えると、2010年と今とでも時代は全然違うなあと思います。</p>

<p>ここまで理解したところで、何もできていない自分に比べたら、Seasarの中心の方々は僕よりも何十倍も優秀な方々の集まりなので、一人ひとりはこの波の中で成功されているのでしょう。でも、Seasarという糊がなければ、彼らはつながらずSeasarは時代の流れの中で役割を終えようとしている中で、外部の者がどうこう言うことではありませんが、同窓会だったとしても十分に価値があったと思います。そこに行って、憧れの彼らが今どうしているのか、話を聞かせてもらえたことは、新参者の自分として、大変刺激的で大変貴重な一日でした。</p>

<p>今、自分の年齢はSeasarの人たちが活発に活動をされていた年齢くらいに位置します。同世代のエンジニアを見渡すとSeasarを作る人は出てこないだろうなあと思いますが、CEOやCTOを名乗っている友人もいますし、ある意味、スタートアップ時代を生きています。そんな中で、僕らは、一まわり上の方の貴重な経験をもっと吸収して、自分たちこそ時代を盛り上げていかなければならない時ではないでしょうか。</p>
]]></content:encoded>
					
					<wfw:commentRss>https://www.susumuis.info/?feed=rss2&#038;p=1389</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Windows8タブレットを買って再会した二次元の「幼なじみ」たち</title>
		<link>https://susumuishigami.github.io/susumuisinfo/entry/2014/windows_tablet_games</link>
					<comments>https://www.susumuis.info/entry/2014/windows_tablet_games#respond</comments>
		
		<dc:creator><![CDATA[susumuis]]></dc:creator>
		<pubDate>Sat, 30 Aug 2014 14:42:16 +0000</pubDate>
				<category><![CDATA[未分類]]></category>
		<guid isPermaLink="false">http://www.susumuis.info/?p=1138</guid>

					<description><![CDATA[僕はモバイル機器を買うと必ず「幼なじみに再会」できるかどうかを試すという儀式的なことを行います。ツッコミはご自由にしてください。何を言われても屈しません。 先日、Windowsタブレットを買いました。 数ある中から僕はL [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>僕はモバイル機器を買うと必ず「幼なじみに再会」できるかどうかを試すという儀式的なことを行います。ツッコミはご自由にしてください。何を言われても屈しません。</p>

<p>先日、Windowsタブレットを買いました。<br />
数ある中から僕はLenovo IdeaPad Miix2 8を選びました、</p>

<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=esuai-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B00GGB7S16" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>

<p>今回はWindowsということで、取り立てて苦労することなくゲームが動くだろうと思ったら結構動きませんでした。せっかくなので結果を報告します。</p>

<p>ところで、このブログはGoogleアドセンス広告を掲載させて頂いているため、いわゆる18禁はNGと思われます。なので、メイドロボットが出てくる昔の葉っ（ｒｙとかいうことを書くことは許されないと思いますので、諦めて全年齢向けの作品のみの情報を扱わせていただきます。</p>

<p>（キャプチャ載せようともしましたが、めんどくさいし、著作権的な問題もあるので省略します。タイトル覚えてる人は脳内補完をよろしくお願いします）</p>

<h2>Kanon全年齢版</h2>

<p>言わずもがな。定番ギャルゲブランドKeyの代表作、ヒロインの名雪さんが最初のシーンで「再会のお祝い」っていうんですね。状況的にバッチリですね！ちなみに、いきなり文字化けしましたが、フォントを変更することで、文字化けはあっさり直りました。</p>

<h3>Air全年齢版</h3>

<p>状況はKanonと同じ感じでした。エンジンのバージョン的にも近いのでしょう。</p>

<h3>CLANNAD</h3>

<p>ストレスなく動きました。いわゆる「クラナドは人生」とか。僕はごめんなさい。最後までやっていないので、せっかくなのでそのうち、攻略しようと思います。</p>

<h3>センチメンタルグラフティ</h3>

<p>全国に散らばるえっと13人でしたっけ、女の子に会うためにバイトでお金を稼いでヒッチハイクの旅をするという、どうしてこうなったのかよくわからない迷作ですね。僕はえみりゅんが好きりゅん。</p>

<p>これはXPのころから、オープニングは見れないから、初期データをでっち上げるという技で起動はしたのですが、なんだかフォントサイズがずれてしまって見るに耐えない状況でした。</p>

<h3>エーベルージュ2</h3>

<p>このシリーズがなければ僕はこの世界を知らないまま学生時代を過ごしたに違いない。その二作目、前作よりもストーリーがキビキビしてて良かったです。メルさんが好きでした。起動することは確認しましたが、キーボードがないと、ゲームを終わらせる手段がなさそうです。これでは困ってしまうので二度と起動することはないでしょう。</p>

<h3>ファンタスティックフォーチュン</h3>

<p>僕がやった唯一の乙女ゲー、乙女ゲーといえど主人公の姫さんが可愛いくて、声優の茶山莉子さんの名前まで覚えてしまった程に、大変満足できた作品でした。が、動きませんねー (T_T)</p>

<h3>Zweii</h3>

<p>ギャルゲじゃないけど、Falcomが作ったキャラがかわいいアクションRPGゲーム。<br />
主人公兄妹に会えたら嬉しかったんですが、いきなり起動しませんでした＞＜</p>

<p>他にも、いくつかのゲームを動かそうとしてみましたが、どうも動かないことが多かったです。寂しいというかなんというか。まあ、そんなものでしょう。どうせ、外に持ちだしていって、公衆の前でにやにやしながらプレイするわけにはいかないので、容量ももったいないし消しちゃいました。</p>

<h2>結論</h2>

<p>幼なじみにいつまでも逢えるってものじゃないのです。きっと、みんなそれぞれの人生を歩んでいったのでしょう。</p>
]]></content:encoded>
					
					<wfw:commentRss>https://www.susumuis.info/?feed=rss2&#038;p=1138</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Let&#8217;s Go! ＃Golang勉強会 Vol.1に参加してきました</title>
		<link>https://susumuishigami.github.io/susumuisinfo/entry/2014/letsgolang</link>
					<comments>https://www.susumuis.info/entry/2014/letsgolang#respond</comments>
		
		<dc:creator><![CDATA[susumuis]]></dc:creator>
		<pubDate>Sun, 27 Jul 2014 12:53:48 +0000</pubDate>
				<category><![CDATA[未分類]]></category>
		<guid isPermaLink="false">http://www.susumuis.info/?p=1123</guid>

					<description><![CDATA[勉強会と Co-Edo について コワーキングスペース茅場町 Co-Edoで行われたGo言語の勉強会Let's Go! ＃Golang勉強会 Vol.1に参加してきました。Co-Edoは去年はじめてのgit勉強会＆もくも [&#8230;]]]></description>
										<content:encoded><![CDATA[<h3>勉強会と Co-Edo について</h3>

<p>コワーキングスペース茅場町 Co-Edoで行われたGo言語の勉強会<a href="http://golang.connpass.com/event/7586/">Let's Go! ＃Golang勉強会 Vol.1</a>に参加してきました。Co-Edoは去年<a href="http://coedo-dev.doorkeeper.jp/events/3692">はじめてのgit勉強会＆もくもく会</a> に参加させていただいたのが初めてでその後利用していませんでしたが、オーナーの田中さんににはその後Facebookでつながっていただいていたので、もう一度利用したいと思って思っていました。</p>

<p>今日の勉強会は、コワーキングスペースの片隅机1,2卓を囲んで参加者4,5人の小さな勉強会でした。僕以外の人はGo言語経験者みたいです。僕は今日はじめてインストールしました。</p>

<h3>Go言語について</h3>

<p>Go言語といえば、Googleが作っている新しいプログラミング言語です。コンパイル式でバイナリを出力できるのが特長で、C++をより開発しやすくしたような立ち位置です。そのため、速度を求められる領域での利用が多く、事例としては、Dockerなどがあります。Gunosyのインフラで使用されていることも有名です。僕のTwitterのTimelineの中でもやっている人をちょくちょく見かけるようになりました。</p>

<h3>初めて触ったGolangの印象</h3>

<p>半日触ってみた印象としては、今からC++を勉強するよりは学びやすい印象を受けました。文法はCやJavaのようでpythonのようなLLの影響も受けている少し独特な記述の言語ですが、使っていればすぐに馴れそうです。</p>

<p><a href="http://revel.github.io">Webフレームワークもあります</a>が、まだ企業で利用するほどには安定していないようです。</p>

<p>しかしライブラリが充実しているので、その気になれば結構良いWebフレームワークやテンプレートエンジンが作れるんじゃないかなと思います。</p>

<h3>作ったプログラム（しょぼいので注意）</h3>

<p>ひとまず、今回僕はGoを使って簡単なWebアプリを作ってみましたｗ</p>

<script src="https://gist.github.com/susumuishigami/e34d34a129a153e3d26d.js"></script>

<p>URLのパラメータにfrom, toを指定して、任意の範囲でグラフィカルなFizzBuzzができるアプリです。誰の役にもたちません（笑）</p>

<p>普通にやると</p>

<pre><code>$ go run web.go
</code></pre>

<p>のようにして、localhost:4000にアクセスして動作を確認できますが、GCE上のDebian（つまり、このブログを動かしているインスタンス）でテストしていたので、4000ポートにアクセスできません。</p>

<p>curlならできますがつまらないですね。</p>

<pre><code>susumuis@instance-4:~$ curl http://localhost:4000/?from=1&amp;to=10
[1] 27781
susumuis@instance-4:~$ &lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;hello, golang&lt;/title&gt;
<script type="text/javascript" src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
&lt;style&gt;
    .fizz { color: red; }
    .buzz { color: blue; }
    .fizzbuzz { size: 1.5rem; color: purple; font-weight: bold; }
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;

to value must be integer
&lt;/body&gt;&lt;/html&gt;
</code></pre>

<p>なので、一時的にこのブログを配信しているnginxに曲がりをしてインターネットに配信しちゃいましたｗｗｗ「おまえ、いきなり本番環境に反映する気か！」などのツッコミには屈しません。（もう落としてます）</p>

<pre><code>    location /goweb/ {
        proxy_pass   http://127.0.0.1:4000;
    }
</code></pre>

<p><a href="http://www.susumuis.info/wp-content/uploads/2014/07/12316618d350799db278bcf46ae4d081.png"><img loading="lazy" decoding="async" src="http://www.susumuis.info/wp-content/uploads/2014/07/12316618d350799db278bcf46ae4d081-300x276.png" alt="golang - web - fizzbuzz" width="300" height="276" class="alignnone size-medium wp-image-1124" srcset="https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2014/07/12316618d350799db278bcf46ae4d081-300x276.png 300w, https://susumuishigami.github.io/susumuisinfo/wp-content/uploads/2014/07/12316618d350799db278bcf46ae4d081.png 604w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>

<p>一応jQueryも入っているのでデバッガで画面いじるのが醍醐味ですｗ</p>

<h3>Goの使いどころ</h3>

<p>まだ事例は少ないですが、静的型付け・コンパイルというのがGoの最大の特長でしょう。それでいてpythonなどのライトウェイト言語の特長を取り込んでいるので、非常に良い言語だと思いました。次のような事例では有効でしょう。</p>

<ul>
<li>インフラなどのリソースを極限まで活用したい</li>
<li>go言語がインストールされていない環境にアプリケーションを配布したい</li>
</ul>

<p>ちなみに、</p>

<pre><code>$ go build web.go
</code></pre>

<p>のようにしたらバイナリを出力できます。出力されたバイナリはgoがインストールされていない環境でも動作するようです。</p>

<pre><code>susumuis@instance-4:~/godev$ go build web.go
susumuis@instance-4:~/godev$ ls -la | grep web
-rwxr-xr-x 1 susumuis susumuis 5703384  7月 27 21:42 web
-rw-r--r-- 1 susumuis susumuis    1466  7月 27 17:43 web.go
</code></pre>

<p>1.4KBのソースコードから吐き出されたバイナリは5.5MBですかｗライブラリを含んでるのか大きいですね。フロッピーに入らない。</p>

<p>GoはWebがまだ弱いので、実質的に、静的型付けが欲しいWeb言語という用途ではまだでしょう。その用途ではFacebookが開発したHackが良いと思います。HackはPHPに型を載せたようなシロモノなので、普通にPHPのエコシステムが使えます。パフォーマンスはFacebookがHHVMを開発して頑張っています。さらに極限までチューニングしたい場合は素直にJavaを使うのが現状一番良いでしょう。ただし、Javaを使えば一律に速くなるというわけではなく、JVMという怪獣を手懐ける必要があります。</p>

<p>僕はその必要性を感じませんが、「サーバーもフロントも同じ言語を使いたい」という場合は、現状はNode一択なのでしょう。Dartがどこまで来るのか興味が湧いています。</p>

<p>実はこのブログを動かしているWordPressにHackで書いた独自プラグインを載せています。そんなことも簡単にできちゃいますが、それについては後日書きます。</p>
]]></content:encoded>
					
					<wfw:commentRss>https://www.susumuis.info/?feed=rss2&#038;p=1123</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>はてなブログからWordPressに移行するためにしたこと</title>
		<link>https://susumuishigami.github.io/susumuisinfo/entry/2014/how_to_move_from_hatena_to_wp</link>
					<comments>https://www.susumuis.info/entry/2014/how_to_move_from_hatena_to_wp#respond</comments>
		
		<dc:creator><![CDATA[susumuis]]></dc:creator>
		<pubDate>Sat, 28 Jun 2014 16:32:04 +0000</pubDate>
				<category><![CDATA[Web技術]]></category>
		<category><![CDATA[未分類]]></category>
		<guid isPermaLink="false">http://www.susumuis.info/?p=973</guid>

					<description><![CDATA[ほっとくと忘れてしまいそうなので、忘れないうちに、記録残そうと思います。 はてなブログから、WordPressへ結構苦労して移行しました。その時やったことをざっと書きたいと思います。 記事の移行 はてなブログ用ツールで記 [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>ほっとくと忘れてしまいそうなので、忘れないうちに、記録残そうと思います。</p>

<p>はてなブログから、WordPressへ結構苦労して移行しました。その時やったことをざっと書きたいと思います。</p>

<h2>記事の移行</h2>

<h3>はてなブログ用ツールで記事データの取得</h3>

<p>定番ですが、下記のツールを利用しました。<br />
<a href="http://smdn.jp/works/tools/HatenaBlogTools/">はてなブログ用ツール</a></p>

<p>.NETで作られているのでWindowsかMonoの環境が必要です。MacもMono環境を整えればできるかもしれないと書いてましたが、Windowsマシン持ってきてやってしまいました。</p>

<p>はてなのAPIを使用しているらしいので、それなら、自分もAPI使ってもいいんですが、せっかくあるツールが使えるなら、やっぱ楽さには叶いません。</p>

<p>このツールでデータをエクスポートしたものは、完全ではありません。次の問題点があります。</p>

<ul>
<li>コメントが含まれない</li>
<li>画像などがはてなフォトライフのままである</li>
<li>シンタックスハイライトなどの装飾が一部崩れている</li>
</ul>

<h3>はてなダイアリーのエクスポート機能を使用</h3>

<p>はてなブログにはエクスポート機能がありませんが、はてなダイアリーにはあります。はてなブログに移行する前ははてなダイアリーを使っていて、はてなダイアリー時代が大半だったので、はてなダイアリーにログインすることではてなダイアリー時代のデータを抜くことは出来ました。</p>

<p>方法は下記の記事と同じです。</p>

<p><a href="http://twi-papa.com/archives/3100">はてなダイアリーからWordPressへ全記事を移行した件 | ツインズパパの徒然日記 Ver.2</a></p>

<p>上記記事にも書いてあるとおり、次の問題点があります。</p>

<ul>
<li>はてなキーワードのリンクもそのまま持ってきてしまう</li>
<li>一部の記事の日付が1970年になってしまう<br />
<br />
<ul>
<li>→これは、時刻 00時代のAMがうまく取り込めないという問題。リンク先や、その方が参考にされたサイトでは01時に変更することで対処されていましたが、僕の場合はAM自体を取り除いたらうまくいきました。</li>
</ul></li>
<li>シンタックスハイライトがガタガタ</li>
<li>画像がはてなフォトラ（ｒｙ</li>
<li>なぜか一部の記事がうまく移行できないで画面が真っ白になった（すごい大昔の記事）</li>
</ul>

<h3>RSSからインポート</h3>

<p>はてなブログはRSSも配信しています。そしてWordPressは公式でRSSからインポートすることができます。しかし、これは、.NETのツールの下位互換でした。</p>

<ul>
<li>新着7件しか取ってこれない</li>
<li>コメントデータを取ってこれない</li>
</ul>

<h3>結局どうしたか</h3>

<ul>
<li>はてなダイアリー時代の記事のうち、真っ白にならなかったものは、はてなダイアリーで移行</li>
<li>はてなブログ時代の記事ははてなブログで移行</li>
<li>はてなブログ時代のコメントは、3件しかなかったので手でSQLを発行して移行：</li>
</ul>

<pre><code class="language-sql">insert into
    wp_comments (
        comment_post_ID,
        comment_author,
        comment_author_url,
        comment_date,
        comment_date_gmt,
        comment_content,
        comment_karma,
        comment_approved,
        comment_parent,
        user_id

    ) values (
        614,
        'susumuis',
        'http://www.susumuis.info/',
        '2014-03-30',
        '2014-03-30',
        'id:faith_and_braveさん コメントありがとうございます。 共感いただいて本当に嬉しいです。 自分は開発（省略）',
        0, 1, 0, 1
    )
</code></pre>

<p>こんな感じです。コマンドラインツールでのSQLの発行はキツイし、phpMyAdminのような「クラックしてください」と言ってるようなツールは使いたくなかったので、このツールを使いました。SSHトンネルの設定もやってくれるので便利でした。</p>

<p><a href="http://www.sequelpro.com">Sequel Pro</a></p>

<p>はてなキーワード持ってきてしまった件についてはSQLに正規表現書いて変換しようとしましたが、MySQLは正規表現を使った置換ができないそうなので、PHPなどの言語で外から変換するしかないようです。まだ出来ていませんので後日できたら報告します。</p>

<h2>検索結果のindexとか「いいね」カウントとか</h2>

<p>検索エンジンのインデックスについては、301リダイレクトで対処するのが王道ですが、これは、</p>

<blockquote>
  <p>はてなダイアリー → はてなブログ → 独自ドメイン(はてなブログPro)</p>
</blockquote>

<p>を公式移行ツールで移行してきたのでシームレスにやってくれていました。なので、あとは、はてなブログProで使っていた独自ドメインのURLそのままで記事のURLを移行するだけです。</p>

<p>WordPressにはパーマリンク機能というのがあって、記事のURLを</p>

<blockquote>
  <p>http://www.example.jp/?p=123<br />
  のようにクエリーパラメータにするのではなく、<br />
  http://www.example.jp/2014/06/28/sample-post/<br />
  のような任意のURLにすることができます。</p>
</blockquote>

<p>ここで、移行前のURLは次の形式になっていました。</p>

<p>はてなブログ時代</p>

<blockquote>
  <p>http://ドメイン/entry/yyyy/mm/dd/数字6桁<br />
  例:<br />
  http://www.susumuis.info/entry/2014/06/11/222935</p>
</blockquote>

<p>はてなダイアリー時代</p>

<blockquote>
  <p>http://ドメイン/entry/yyyymmdd/p数字<br />
  http://ドメイン/entry/yyyymmdd/数字10桁<br />
  http://ドメイン/entry/yyyymmdd/任意の単語<br />
  例:<br />
  http://www.susumuis.info/entry/20110728/p1<br />
  http://www.susumuis.info/entry/20090822/1252377609</p>
</blockquote>

<p>見事に分かれています。それなら、共通する、「/entry/2014」の部分 + 投稿名として「06/11/XXXXXX」を書くようにしようとしましたがこれはできません。</p>

<p>"/"という文字が投稿名に使用できなかったためです。</p>

<p>結局どうしたかというと、 <code>Enhanced Custom Permalinks</code>というプラグインのお世話になりました。これを使えば記事ごとにパーマリンクを設定できます。</p>

<p>さて、記事の数は90くらいありますので、全部手でやってたら大変ですから、こいつは、SQLで一括で設定してしまいました。</p>

<p>当時のクエリを残していなかったので、正確なものを紹介できませんが、<code>wp_postmeta</code>テーブルをinsertしていく形になります。</p>

<p>単なる301ではなく、URLを同一にしたため、はてなスター、Facebookいいねまでそのまま引き継ぐことが出来ました！</p>

<h2>はてなブックマーク、はてブコメント</h2>

<p>ところが、はてなブックマークについてはうまく行きませんでした。はてなブックマークもURLに紐づく情報なので、てっきりブログをそのまま移行すれば、独自ドメインでブックマークが引き継がれると思っていました。確かに移行直後はそうだったのですが、移行後数時間後、はてなブックマークカウントが0になっていました。</p>

<p>なんでかなあと思ってみたところ、はてなブログProの管理画面を見たら理由がわかりました。</p>

<h3>独自ドメインは解除されている！</h3>

<p>はてなブログは、定期的にドメインが有効かどうかクロールしているようです。ドメインがきちんとはてなのDNSに向いていることがわかった時点で、元のはてなブログのURLから独自ドメインのURLにリダイレクトしているようです。</p>

<p>ドメインが無効、または別のサーバーを向いていると判断されると、はてなブログのドメインから独自ドメインへの転送がストップします。それと同時に、はてなブックマークのデータも、元のはてなブログのドメインのものに変換され、独自ドメインのカウントは、0になります。はてなブログとして独自ドメインで受けたはてなブックマークカウントも、一緒にはてなブログドメインに持って行かれてしまいます。</p>

<p>はてなブックマークははてなのものだから仕方がないですね。</p>

<h3>人気エントリー一覧</h3>

<p>人気エントリーの一覧は、元のはてなブログドメインのものをはてなブックマークブログパーツを使用すれば作成できます。このままだとリンク先がはてなブログになってしまうので、リンク先をJavaScriptで強引に書き換えてしまいました。右サイドバーの「以前反響を頂いた記事」という部分です。具体的にはこんな感じです。</p>

<pre><code class="language-JavaScript">jQuery('div#hatena_hotentry').on('DOMNodeInserted', function() {
  $links = jQuery('div#hatena_hotentry .hatena-bookmark-entrytitle');
  $links.each(function() {
    jQuery(this).attr('href', jQuery(this).attr('href').replace('susumuis.hateblo.jp', 'www.susumuis.info'))
  });
});
</code></pre>

<p>こんなことして怒られたらやめます。ｗｗもう、この段階で欲しいのは過去のはてなブックマークじゃなくて、この記事がオススメだよっていうことなので、僕の方で勝手にレコメンドしちゃえばいいんです。</p>

<h3>ブックマークコメント</h3>

<p>はてなブックマークコメントはどうしましょう。最近はブログのコメント機能を使ってのコメントより、はてなブックマークコメントで暑いコメントをもらったりします。</p>

<p>はてブコメントがないと、過去盛り上がった記事もなんか寂しい感じですね。ただ、個人的には、はてなブックマークに対しては歓迎的でない部分もあって、何かと炎上しやすいなど、攻撃的なこと書く人がたまにいます。</p>

<p>コメントなのか、個人のメモなのかわからないしろものですから、今後、ブログの雰囲気的を良くしていくためにはない方が良いかもしれません。</p>

<p>ということで、過去の記事まで追跡して、はてブコメントを画面に出すのはやめました。ただ、僕のブログのなかで、はてブ2桁頂いた記事が6件だけあったのでそれらについては記事の下に手動で旧ドメインでのブックマークリンクを記載しました。こんなかんじです。</p>

<pre><code class="language-markup">この記事は以前多くのブックマーク・コメントを頂きました。
&lt;a href="http://b.hatena.ne.jp/entry/http://susumuis.hateblo.jp/entry/20110728/p1" class="hatena-bookmark-button" data-hatena-bookmark-layout="simple-balloon" title="以前のURLでのブックマーク件数"&gt;&lt;/a&gt;
これからブックマークされる方はこちら↓
</code></pre>

<h2>Markdown記法を使えるようにする</h2>

<p>WordPressにはMarkdownを使えるようにするプラグインが複数存在します。いろいろ試しましたが僕はこのプラグインが使いやすいと思いました。</p>

<p><a href="https://github.com/qckanemoto/wp-markdown-live">WP Markdown Live</a></p>

<h2>コードのインデントとシンタックスハイライト</h2>

<p>はてなダイアリーやはてなブログから記事をインポートした結果、残念なこととして、ソースコードのインデントやシンタックスハイライトがガタガタになってしまったことがありました。</p>

<p>これについては、幸いWP Markdown LiveプラグインがGitHub風のプログラムコード記法を持っているので、テキスト化されたコードからもう一度自前でインデントしてMarkdownに貼り直すことにしました。全部だと大変だから一部だけです。</p>

<p>これだとシンタックスハイライトがつきませんがWP Markdown Liveで出力したコードは</p>

<pre><code class="language-markup">&lt;ｐre class=" language-css"&gt;
&lt;code class=" language-css" data-language="css"&gt;

コード

&lt;/code&gt;
&lt;/pre&gt;
</code></pre>

<p>(＊うまくコードをテキスト化してくれないので、最初のpだけ全角文字にしています)<br />
のように出力されます。これはそのまま <a href="http://prismjs.com">prism.js</a>が使用できます。</p>

<p>テーマのスタイルシートにダウンロードしてきたprism.cssとjsを配置するだけで、綺麗にシンタックスハイライトすることができました。</p>

<h2>SEOとかOGPとかTwitter連携とか</h2>

<p>まだまだやらなきゃいけないことはたくさんありますが、だんだん面倒くさくなってきてしまったので、これらはプラグインでお茶をにごしました。<br />
余力があったらプラグインを使わずに自力で連携したいです。</p>

<p>使ったプラグイン<br />
* Jetpack by WordPress.com<br />
* WP Open Graph<br />
* WP Social Bookmarking Light</p>

<p>Jetpack使ってるあたりが負けてる感がするので、早急に自力でなんとかしたいです。</p>

<p>SEOのメタタグの部分はしっくり来るプラグインが見つからなかったので自分でheader.phpにスクリプト書きました。</p>
]]></content:encoded>
					
					<wfw:commentRss>https://www.susumuis.info/?feed=rss2&#038;p=973</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
	</channel>
</rss>
